{"version":3,"file":"pixi-animate-container.js","sources":["../src/createjs/modules/ButtonHelper.ts","../src/createjs/modules/utils.ts","../src/createjs/modules/core.ts","../src/createjs/modules/Stage.ts","../src/createjs/modules/EventManager.ts","../src/createjs/modules/StageGL.ts","../src/createjs/modules/MovieClip.ts","../src/createjs/modules/Sprite.ts","../src/createjs/modules/Shape.ts","../src/createjs/modules/Bitmap.ts","../src/createjs/modules/Graphics.ts","../src/createjs/modules/Text.ts","../src/createjs/modules/ColorFilter.ts","../src/createjs/core.ts","../src/Container.ts","../src/index.ts"],"sourcesContent":["import createjs from '@tawaship/createjs-module';\r\n\r\n/**\r\n * inherited {@link https://createjs.com/docs/easeljs/classes/ButtonHelper.html | createjs.ButtonHelper}\r\n */\r\nexport class CreatejsButtonHelper extends createjs.ButtonHelper {\r\n\tconstructor(...args: any[]) {\r\n\t\tsuper(...args);\r\n\t\t\r\n\t\tconst createjs = args[0];\r\n\t\tconst pixi = createjs.pixi;\r\n\t\t\r\n\t\tconst baseFrame = args[1];\r\n\t\tconst overFrame = args[2];\r\n\t\tconst downFrame = args[3];\r\n\t\tconst hit = arguments[5];\r\n\t\tconst hitFrame = args[6];\r\n\t\t\r\n\t\thit.gotoAndStop(hitFrame);\r\n\t\tconst hitPixi = pixi.addChild(hit.pixi);\r\n\t\thitPixi.alpha = 0.00001;\r\n\t\t\r\n\t\tlet isOver = false;\r\n\t\tlet isDown = false;\r\n\t\t\r\n\t\thitPixi.on('pointerover', function() {\r\n\t\t\tisOver = true;\r\n\t\t\tif (isDown) {\r\n\t\t\t\tcreatejs.gotoAndStop(downFrame);\r\n\t\t\t} else {\r\n\t\t\t\tcreatejs.gotoAndStop(overFrame);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\thitPixi.on('pointerout', function() {\r\n\t\t\tisOver = false;\r\n\t\t\t\r\n\t\t\tif (isDown) {\r\n\t\t\t\tcreatejs.gotoAndStop(overFrame);\r\n\t\t\t} else {\r\n\t\t\t\tcreatejs.gotoAndStop(baseFrame);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\thitPixi.on('pointerdown', function() {\r\n\t\t\tisDown = true;\r\n\t\t\tcreatejs.gotoAndStop(downFrame);\r\n\t\t});\r\n\t\t\r\n\t\thitPixi.on('pointerup', function() {\r\n\t\t\tisDown = false;\r\n\t\t\tif (isOver) {\r\n\t\t\t\tcreatejs.gotoAndStop(overFrame);\r\n\t\t\t} else {\r\n\t\t\t\tcreatejs.gotoAndStop(baseFrame);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\thitPixi.on('pointerupoutside', function() {\r\n\t\t\tisDown = false;\r\n\t\t\tif (isOver) {\r\n\t\t\t\tcreatejs.gotoAndStop(overFrame);\r\n\t\t\t} else {\r\n\t\t\t\tcreatejs.gotoAndStop(baseFrame);\r\n\t\t\t}\r\n\t\t});\r\n\t\t\r\n\t\thitPixi.interactive = true;\r\n\t\thitPixi.cursor = 'pointer';\r\n\t}\r\n}","export function createObject<T>(proto: object): T {\r\n\treturn Object.create(proto);\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nexport const DEG_TO_RAD = Math.PI / 180;","import { Container, Point } from 'pixi.js';\r\nimport { CreatejsButtonHelper } from './ButtonHelper';\r\nimport { CreatejsStage } from './Stage';\r\nimport { CreatejsStageGL } from './StageGL';\r\nimport { CreatejsMovieClip } from './MovieClip';\r\nimport { CreatejsSprite } from './Sprite';\r\nimport { CreatejsShape } from './Shape';\r\nimport { CreatejsBitmap } from './Bitmap';\r\nimport { CreatejsGraphics } from './Graphics';\r\nimport { CreatejsText } from './Text';\r\nimport { CreatejsEventManager, ICreatejsInteractionEventDelegate, createjsInteractionEvents } from './EventManager';\r\nimport { DEG_TO_RAD } from './utils';\r\n\r\nexport interface ITickerData {\r\n\tdelta: number;\r\n}\r\n\r\nexport interface IPixiData<T extends Container> {\r\n\tregObj: Point;\r\n\tinstance: T;\r\n\treservedBlendMode: PIXI.BLEND_MODES;\r\n}\r\n\r\nexport function createPixiData<TPixiDisplayObject extends Container>(pixi: TPixiDisplayObject, regObj: Point): IPixiData<TPixiDisplayObject> {\r\n\treturn {\r\n\t\tregObj,\r\n\t\tinstance: pixi,\r\n\t\treservedBlendMode: PIXI.BLEND_MODES.NORMAL\r\n\t};\r\n}\r\n\r\nexport type TCreatejsMask = CreatejsShape | null;\r\n\r\nexport interface ICreatejsParam {\r\n\tx: number;\r\n\ty: number;\r\n\tscaleX: number;\r\n\tscaleY: number;\r\n\tregX: number;\r\n\tregY: number;\r\n\tskewX: number;\r\n\tskewY: number;\r\n\trotation: number;\r\n\tvisible: boolean;\r\n\talpha: number;\r\n\t_off: boolean;\r\n\tmask: TCreatejsMask;\r\n}\r\n\r\nexport type TCreatejsObject =\r\n\tCreatejsStage\r\n\t| CreatejsStageGL\r\n\t| CreatejsMovieClip\r\n\t| CreatejsSprite\r\n\t| CreatejsShape\r\n\t| CreatejsBitmap\r\n\t| CreatejsGraphics\r\n\t| CreatejsText;\r\n\r\nexport function createCreatejsParams(): ICreatejsParam {\r\n\treturn {\r\n\t\tx: 0,\r\n\t\ty: 0,\r\n\t\tscaleX: 0,\r\n\t\tscaleY: 0,\r\n\t\tregX: 0,\r\n\t\tregY: 0,\r\n\t\tskewX: 0,\r\n\t\tskewY: 0,\r\n\t\trotation: 0,\r\n\t\tvisible: true,\r\n\t\talpha: 1,\r\n\t\t_off: false,\r\n\t\tmask: null\r\n\t};\r\n}\r\n\r\nexport type TCreatejsDisplayObject = any/* createjs.DisplayObject */;\r\n\r\nexport interface ICreatejsDisplayObjectUpdater extends TCreatejsDisplayObject {\r\n\tupdateForPixi(e: ITickerData): boolean;\r\n\tupdateBlendModeForPixi(mode: PIXI.BLEND_MODES): void;\r\n}\r\n\r\nexport interface ICreatejsDisplayObjectInitializer {\r\n\tinitialize(...args: any[]): any;\r\n}\r\n\r\nexport function updateDisplayObjectChildren(cjs: ICreatejsDisplayObjectUpdater, e: ITickerData) {\r\n\tconst list = cjs.children.slice();\r\n\tfor (let i = 0, l = list.length; i < l; i++) {\r\n\t\tconst child = list[i];\r\n\t\tchild.updateForPixi(e);\r\n\t}\r\n\t\r\n\treturn true;\r\n}\r\n\r\nexport interface IMixinedCreatejsDisplayObject<T extends Container> extends ICreatejsParam, TCreatejsDisplayObject {\r\n\tpixi: T;\r\n\taddEventListener(type: string, cb: ICreatejsInteractionEventDelegate | CreatejsButtonHelper, ...args: any[]): any;\r\n\tremoveEventListener(type: string, cb: ICreatejsInteractionEventDelegate, ...args: any[]): any;\r\n\tremoveAllEventListeners(type?: string, ...args: any[]): any;\r\n}\r\n\r\n// export type TMixinedCreatejsDisplayObjectClass = abstract new (...args: any[]) => IMixinedCreatejsDisplayObject;\r\n\r\nexport function mixinCreatejsDisplayObject<T extends Container, U extends ICreatejsParam>(superClass: new (...args: any[]) => IMixinedCreatejsDisplayObject<T>): abstract new (...args: any[]) => IMixinedCreatejsDisplayObject<T> {\r\n\tabstract class C extends superClass {\r\n\t\tprotected abstract _pixiData: IPixiData<T>;\r\n\t\tprotected abstract _createjsParams: ICreatejsParam;\r\n\t\tprotected abstract _createjsEventManager: CreatejsEventManager;\r\n\r\n\t\tget pixi() {\r\n\t\t\treturn this._pixiData.instance;\r\n\t\t}\r\n\t\t\r\n\t\tget x() {\r\n\t\t\treturn this._createjsParams.x;\r\n\t\t}\r\n\t\t\r\n\t\tset x(value) {\r\n\t\t\tthis._pixiData.instance.x = value;\r\n\t\t\tthis._createjsParams.x = value;\r\n\t\t}\r\n\t\t\r\n\t\tget y() {\r\n\t\t\treturn this._createjsParams.y;\r\n\t\t}\r\n\t\t\r\n\t\tset y(value) {\r\n\t\t\tthis._pixiData.instance.y = value;\r\n\t\t\tthis._createjsParams.y = value;\r\n\t\t}\r\n\t\t\r\n\t\tget scaleX() {\r\n\t\t\treturn this._createjsParams.scaleX;\r\n\t\t}\r\n\t\t\t\r\n\t\tset scaleX(value) {\r\n\t\t\tthis._pixiData.instance.scale.x = value;\r\n\t\t\tthis._createjsParams.scaleX = value;\r\n\t\t}\r\n\t\t\r\n\t\tget scaleY() {\r\n\t\t\treturn this._createjsParams.scaleY;\r\n\t\t}\r\n\t\t\r\n\t\tset scaleY(value) {\r\n\t\t\tthis._pixiData.instance.scale.y = value;\r\n\t\t\tthis._createjsParams.scaleY = value;\r\n\t\t}\r\n\t\t\r\n\t\tget skewX() {\r\n\t\t\treturn this._createjsParams.skewX;\r\n\t\t}\r\n\t\t\r\n\t\tset skewX(value) {\r\n\t\t\tthis._pixiData.instance.skew.x = -value * DEG_TO_RAD;\r\n\t\t\tthis._createjsParams.skewX = value;\r\n\t\t}\r\n\t\t\r\n\t\tget skewY() {\r\n\t\t\treturn this._createjsParams.skewY;\r\n\t\t}\r\n\t\t\r\n\t\tset skewY(value) {\r\n\t\t\tthis._pixiData.instance.skew.y = value * DEG_TO_RAD;\r\n\t\t\tthis._createjsParams.skewY = value;\r\n\t\t}\r\n\t\t\r\n\t\tget regX() {\r\n\t\t\treturn this._createjsParams.regX;\r\n\t\t}\r\n\t\t\r\n\t\tset regX(value) {\r\n\t\t\tthis._pixiData.regObj.x = value;\r\n\t\t\tthis._createjsParams.regX = value;\r\n\t\t}\r\n\t\t\r\n\t\tget regY() {\r\n\t\t\treturn this._createjsParams.regY;\r\n\t\t}\r\n\t\t\r\n\t\tset regY(value) {\r\n\t\t\tthis._pixiData.regObj.y = value;\r\n\t\t\tthis._createjsParams.regY = value;\r\n\t\t}\r\n\t\t\r\n\t\tget rotation() {\r\n\t\t\treturn this._createjsParams.rotation;\r\n\t\t}\r\n\t\t\r\n\t\tset rotation(value) {\r\n\t\t\tthis._pixiData.instance.rotation = value * DEG_TO_RAD;\r\n\t\t\tthis._createjsParams.rotation = value;\r\n\t\t}\r\n\t\t\r\n\t\tget visible() {\r\n\t\t\treturn this._createjsParams.visible;\r\n\t\t}\r\n\t\t\r\n\t\tset visible(value) {\r\n\t\t\tvalue = !!value;\r\n\t\t\tthis._pixiData.instance.visible = value;\r\n\t\t\tthis._createjsParams.visible = value;\r\n\t\t}\r\n\t\t\r\n\t\tget alpha() {\r\n\t\t\treturn this._createjsParams.alpha;\r\n\t\t}\r\n\t\t\r\n\t\tset alpha(value) {\r\n\t\t\tthis._pixiData.instance.alpha = value;\r\n\t\t\tthis._createjsParams.alpha = value;\r\n\t\t}\r\n\t\t\r\n\t\tget _off() {\r\n\t\t\treturn this._createjsParams._off;\r\n\t\t}\r\n\t\t\r\n\t\tset _off(value) {\r\n\t\t\tthis._pixiData.instance.renderable = !value;\r\n\t\t\tthis._createjsParams._off = value;\r\n\t\t}\r\n\t\t\r\n\t\taddEventListener(type: createjsInteractionEvents, cb: ICreatejsInteractionEventDelegate | CreatejsButtonHelper, ...args: any[]) {\r\n\t\t\tconst p = super.addEventListener(type, cb, ...args);\r\n\t\t\tif (!(cb instanceof CreatejsButtonHelper)) {\r\n\t\t\t\tthis._createjsEventManager.add(type, cb);\r\n\t\t\t}\r\n\r\n\t\t\treturn p;\r\n\t\t}\r\n\t\t\r\n\t\tremoveEventListener(type: createjsInteractionEvents, cb: ICreatejsInteractionEventDelegate, ...args: any[]) {\r\n\t\t\tconst p = super.removeEventListener(type, cb, ...args);\r\n\t\t\tif (!(cb instanceof CreatejsButtonHelper)) {\r\n\t\t\t\tthis._createjsEventManager.remove(type, cb);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn p;\r\n\t\t}\r\n\t\t\r\n\t\tremoveAllEventListeners(type?: string, ...args: any[]) {\r\n\t\t\tconst p = super.removeAllEventListeners(type, ...args);\r\n\t\t\tthis._createjsEventManager.removeAll(type);\r\n\r\n\t\t\treturn p;\r\n\t\t}\r\n\t\t\r\n\t\tget mask() {\r\n\t\t\treturn this._createjsParams.mask;\r\n\t\t}\r\n\t\t\r\n\t\tset mask(value: TCreatejsMask) {\r\n\t\t\tif (value) {\r\n\t\t\t\tvalue.masked.push(this._pixiData.instance);\r\n\t\t\t\tthis._pixiData.instance.mask = value.pixi;\r\n\t\t\t\t\r\n\t\t\t\tthis._pixiData.instance.once('added', () => {\r\n\t\t\t\t\tthis._pixiData.instance.parent.addChild(value.pixi);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthis._pixiData.instance.mask = null;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthis._createjsParams.mask = value;\r\n\t\t}\r\n\t}\r\n\t\r\n\treturn C;\r\n}","import createjs from '@tawaship/createjs-module';\r\nimport { updateDisplayObjectChildren, ITickerData, ICreatejsDisplayObjectUpdater } from './core';\r\n\r\n/**\r\n * inherited {@link https://createjs.com/docs/easeljs/classes/Stage.html | createjs.Stage}\r\n */\r\nexport class CreatejsStage extends createjs.Stage implements ICreatejsDisplayObjectUpdater {\r\n\tupdateForPixi(props: ITickerData) {\r\n\t\tif (this.tickOnUpdate) { this.tick(props); }\r\n\t\tthis.dispatchEvent(\"drawstart\");\r\n\t\tupdateDisplayObjectChildren(this, props);\r\n\t\tthis.dispatchEvent(\"drawend\");\r\n\t\t\r\n\t\treturn true;\r\n\t}\r\n\r\n\tupdateBlendModeForPixi(mode: PIXI.BLEND_MODES): void {\r\n\t\t\r\n\t}\r\n}","import { TCreatejsObject } from './core';\r\nimport { utils } from 'pixi.js';\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst createjsInteractionEventsa = {\r\n\tmousedown: true,\r\n\tpressmove: true,\r\n\tpressup: true,\r\n\trollover: true,\r\n\trollout: true,\r\n\tclick: true\r\n};\r\n\r\nexport enum createjsInteractionEvents {\r\n\tmousedown = \"mousedown\",\r\n\tpressmove = \"pressmove\",\r\n\tpressup = \"pressup\",\r\n\trollover = \"rollover\",\r\n\trollout = \"rollout\",\r\n\tclick = \"click\",\r\n}\r\n\r\n/**\r\n * Event object passed to createjs interaction event handler.\r\n * \r\n * It is different from the createjs event because it converts the event that occurred on pixi.js.\r\n * There may be fewer properties and the property values may not match the createjs event values.\r\n * Therefore, we recommend that you do not implement interaction processing with createjs, but with pixi.js.\r\n * \r\n * - `target`\r\n * A different object may be stored than the createjs event.\r\n *\r\n * - `rawX`, `rawY`\r\n * Global coordinates in the pixi.js canvas are stored.\r\n * When playing with createjs, the content is always placed at the canvas's global coordinates (0, 0), but this plugin allows you to freely change the coordinates of the createjs instance, so the values may shift.\r\n */\r\nexport interface ICreatejsInteractionEvent {\r\n\ttype: createjsInteractionEvents | null;\r\n\tcurrentTarget: TCreatejsObject | null;\r\n\ttarget: TCreatejsObject | null;\r\n\trawX: number;\r\n\trawY: number;\r\n}\r\n\r\nexport interface ICreatejsInteractionEventDelegate {\r\n\t (e: any): void;\r\n}\r\n\r\nexport class CreatejsEventManager {\r\n\tprivate _downTarget: TCreatejsObject | null = null;\r\n\tprivate _emitter: utils.EventEmitter;\r\n\tprivate _cjs: TCreatejsObject;\r\n\t\r\n\tconstructor(cjs: TCreatejsObject) {\r\n\t\tthis._cjs = cjs;\r\n\t\tthis._emitter = new utils.EventEmitter();\r\n\t\t\r\n\t\tconst pixi = cjs.pixi;\r\n\t\t\r\n\t\tpixi\r\n\t\t.on('pointerdown', this._onPointerDown, this)\r\n\t\t.on('pointermove', this._onPointerMove, this)\r\n\t\t.on('pointerup', this._onPointerUp, this)\r\n\t\t.on('pointerupoutside', this._onPointerUpOutside, this)\r\n\t\t.on('pointertap', this._onPointerTap, this)\r\n\t\t.on('pointerover', this._onPointerOver, this)\r\n\t\t.on('pointerout', this._onPointerOut, this);\r\n\t}\r\n\t\r\n\tprivate _onPointerDown(e: any) {\r\n\t\tconst ev: ICreatejsInteractionEvent = {\r\n\t\t\ttype: createjsInteractionEvents.mousedown,\r\n\t\t\tcurrentTarget: e.currentTarget.createjs,\r\n\t\t\ttarget: e.target.createjs,\r\n\t\t\trawX: e.data.global.x,\r\n\t\t\trawY: e.data.global.y,\r\n\t\t};\r\n\t\t\r\n\t\tthis._downTarget = e.target.createjs;\r\n\t\t\r\n\t\tthis._emitter.emit('mousedown', ev);\r\n\t}\r\n\t\r\n\tprivate _onPointerMove(e: any) {\r\n\t\tif (!this._downTarget) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst ev: ICreatejsInteractionEvent = {\r\n\t\t\ttype: createjsInteractionEvents.pressmove,\r\n\t\t\tcurrentTarget: e.currentTarget.createjs,\r\n\t\t\ttarget: this._downTarget,\r\n\t\t\trawX: e.data.global.x,\r\n\t\t\trawY: e.data.global.y,\r\n\t\t};\r\n\t\t\r\n\t\tthis._emitter.emit('pressmove', ev);\r\n\t}\r\n\t\r\n\tprivate _onPointerUp(e: any) {\r\n\t\tconst ev: ICreatejsInteractionEvent = {\r\n\t\t\ttype: createjsInteractionEvents.pressup,\r\n\t\t\tcurrentTarget: e.currentTarget.createjs,\r\n\t\t\ttarget: this._downTarget,\r\n\t\t\trawX: e.data.global.x,\r\n\t\t\trawY: e.data.global.y,\r\n\t\t};\r\n\r\n\t\tthis._downTarget = null;\r\n\t\t\r\n\t\tthis._emitter.emit('pressup', ev);\r\n\t}\r\n\t\r\n\tprivate _onPointerUpOutside(e: any) {\r\n\t\tconst ev: ICreatejsInteractionEvent = {\r\n\t\t\ttype: createjsInteractionEvents.pressup,\r\n\t\t\tcurrentTarget: e.currentTarget.createjs,\r\n\t\t\ttarget: this._downTarget,\r\n\t\t\trawX: e.data.global.x,\r\n\t\t\trawY: e.data.global.y,\r\n\t\t};\r\n\r\n\t\tthis._downTarget = null;\r\n\t\t\r\n\t\tthis._emitter.emit('pressup', ev);\r\n\t}\r\n\t\r\n\tprivate _onPointerTap(e: any) {\r\n\t\tconst ev: ICreatejsInteractionEvent = {\r\n\t\t\ttype: createjsInteractionEvents.click,\r\n\t\t\tcurrentTarget: e.currentTarget.createjs,\r\n\t\t\ttarget: e.target.createjs,\r\n\t\t\trawX: e.data.global.x,\r\n\t\t\trawY: e.data.global.y,\r\n\t\t};\r\n\r\n\t\tthis._emitter.emit('click', ev);\r\n\t}\r\n\t\r\n\tprivate _onPointerOver(e: any) {\r\n\t\tconst ev: ICreatejsInteractionEvent = {\r\n\t\t\ttype: createjsInteractionEvents.rollover,\r\n\t\t\tcurrentTarget: e.currentTarget.createjs,\r\n\t\t\ttarget: e.currentTarget.createjs,\r\n\t\t\trawX: e.data.global.x,\r\n\t\t\trawY: e.data.global.y,\r\n\t\t};\r\n\r\n\t\tthis._emitter.emit('rollover', ev);\r\n\t}\r\n\t\r\n\tprivate _onPointerOut(e: any) {\r\n\t\tconst ev: ICreatejsInteractionEvent = {\r\n\t\t\ttype: createjsInteractionEvents.rollout,\r\n\t\t\tcurrentTarget: e.currentTarget.createjs,\r\n\t\t\ttarget: e.currentTarget.createjs,\r\n\t\t\trawX: e.data.global.x,\r\n\t\t\trawY: e.data.global.y,\r\n\t\t};\r\n\r\n\t\tthis._emitter.emit('rollout', ev);\r\n\t}\r\n\t\r\n\tadd(type: createjsInteractionEvents, cb: ICreatejsInteractionEventDelegate) {\r\n\t\tif (!(type in createjsInteractionEvents)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._emitter.on(type, cb);\r\n\t\t\r\n\t\tif (this._emitter.eventNames().length > 0) {\r\n\t\t\tthis._cjs.pixi.interactive = true;\r\n\t\t}\r\n\t}\r\n\t\r\n\tremove(type: createjsInteractionEvents, cb: ICreatejsInteractionEventDelegate) {\r\n\t\tif (!(type in createjsInteractionEvents)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._emitter.off(type, cb);\r\n\t\t\r\n\t\tif (this._emitter.eventNames().length === 0) {\r\n\t\t\tthis._cjs.pixi.interactive = false;\r\n\t\t}\r\n\t}\r\n\t\r\n\tremoveAll(type?: string) {\r\n\t\tif (type && !(type in createjsInteractionEvents)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tthis._emitter.removeAllListeners(type);\r\n\t\t\r\n\t\tif (this._emitter.eventNames().length === 0) {\r\n\t\t\tthis._cjs.pixi.interactive = false;\r\n\t\t}\r\n\t}\r\n}","import createjs from '@tawaship/createjs-module';\r\nimport { updateDisplayObjectChildren, ITickerData, ICreatejsDisplayObjectUpdater } from './core';\r\n\r\n/**\r\n * inherited {@link https://createjs.com/docs/easeljs/classes/StageGL.html | createjs.StageGL}\r\n */\r\nexport class CreatejsStageGL extends createjs.StageGL implements ICreatejsDisplayObjectUpdater {\r\n\tupdateForPixi(props: ITickerData) {\r\n\t\tif (this.tickOnUpdate) { this.tick(props); }\r\n\t\tthis.dispatchEvent(\"drawstart\");\r\n\t\tupdateDisplayObjectChildren(this, props);\r\n\t\tthis.dispatchEvent(\"drawend\");\r\n\t\t\r\n\t\treturn true;\r\n\t}\r\n\r\n\tupdateBlendModeForPixi(mode: PIXI.BLEND_MODES): void {\r\n\t\t\r\n\t}\r\n}","import { Container } from 'pixi.js';\r\nimport createjs from '@tawaship/createjs-module';\r\nimport { CreatejsColorFilter, PixiColorMatrixFilter } from './ColorFilter';\r\nimport { mixinCreatejsDisplayObject, createPixiData, createCreatejsParams, IPixiData, ICreatejsParam, updateDisplayObjectChildren, ITickerData, ICreatejsDisplayObjectUpdater, ICreatejsDisplayObjectInitializer } from './core';\r\nimport { createObject } from './utils';\r\nimport { CreatejsEventManager } from './EventManager';\r\n\r\n/**\r\n * inherited {@link http://pixijs.download/v5.3.2/docs/PIXI.Container.html | PIXI.Container}\r\n */\r\nexport class PixiMovieClip extends Container {\r\n\tprivate _createjs: CreatejsMovieClip;\r\n\tprivate _filterContainer: Container | null = null;\r\n\t\r\n\tconstructor(cjs: CreatejsMovieClip) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._createjs = cjs;\r\n\t}\r\n\t\r\n\tget filterContainer() {\r\n\t\treturn this._filterContainer;\r\n\t}\r\n\t\r\n\tset filterContainer(value) {\r\n\t\tthis._filterContainer = value;\r\n\t}\r\n\t\r\n\tget createjs() {\r\n\t\treturn this._createjs;\r\n\t}\r\n}\r\n\r\nexport type TCreatejsColorFilters = CreatejsColorFilter[] | null;\r\n\r\nexport interface ICreatejsMovieClipParam extends ICreatejsParam {\r\n\tfilters: TCreatejsColorFilters;\r\n\tcompositeOperation: CompositeOpeations | null;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createCreatejsMovieClipParams(): ICreatejsMovieClipParam {\r\n\treturn Object.assign(createCreatejsParams(), {\r\n\t\tfilters: null,\r\n\t\tcompositeOperation: null\r\n\t});\r\n}\r\n\r\nexport interface IPixiMovieClipData extends IPixiData<PixiMovieClip> {\r\n\tsubInstance: Container;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createPixiMovieClipData(cjs: CreatejsMovieClip): IPixiMovieClipData {\r\n\tconst pixi = new PixiMovieClip(cjs);\r\n\t\r\n\treturn Object.assign(createPixiData<PixiMovieClip>(pixi, pixi.pivot), {\r\n\t\tsubInstance: pixi\r\n\t});\r\n}\r\n\r\nexport class AnimateEvent extends createjs.Event {\r\n\tconstructor(type: string) {\r\n\t\tsuper(type);\r\n\t}\r\n};\r\n\r\nexport interface IAnimateReachLabelData {\r\n\t/**\r\n\t * Label name.\r\n\t */\r\n\tlabel: string;\r\n\t\r\n\t/**\r\n\t * Frame number of label.\r\n\t */\r\n\tposition: number;\r\n}\r\n\r\nexport class AnimateReachLabelEvent extends AnimateEvent {\r\n\tdata: IAnimateReachLabelData;\r\n\t\r\n\tconstructor(type: string, label: IAnimateReachLabelData) {\r\n\t\tsuper(type);\r\n\t\t\r\n\t\tthis.data = label;\r\n\t}\r\n}\r\n\r\nexport interface IAnimateFrameEventOption {\r\n\t/**\r\n\t * Whether to fire {@link CreatejsMovieClip.endAnimation}\r\n\t */\r\n\tendAnimation?: boolean;\r\n\r\n\t/**\r\n\t * Whether to fire {@link CreatejsMovieClip.reachLabel}\r\n\t */\r\n\treachLabel?: boolean;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst P = createjs.MovieClip;\r\n\r\n/**\r\n * @ignore\r\n */\r\nenum CompositeOpeations {\r\n\tLighter = \"lighter\",\r\n\tMultiply = \"multiply\",\r\n\tScreen = \"screen\"\r\n};\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst blendModes = {\r\n\t[CompositeOpeations.Lighter]: PIXI.BLEND_MODES.ADD,\r\n\t[CompositeOpeations.Multiply]: PIXI.BLEND_MODES.MULTIPLY,\r\n\t[CompositeOpeations.Screen]: PIXI.BLEND_MODES.SCREEN,\r\n};\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst T: number = 1000 / 60;\r\n\r\n/**\r\n * inherited {@link https://createjs.com/docs/easeljs/classes/MovieClip.html | createjs.MovieClip}\r\n */\r\nexport class CreatejsMovieClip extends mixinCreatejsDisplayObject<PixiMovieClip, ICreatejsMovieClipParam>(createjs.MovieClip) implements ICreatejsDisplayObjectUpdater, ICreatejsDisplayObjectInitializer {\r\n\tprotected _pixiData: IPixiMovieClipData;\r\n\tprotected _createjsParams: ICreatejsMovieClipParam;\r\n\tprotected _createjsEventManager: CreatejsEventManager;\r\n\r\n\tdeclare protected _framerateBase: number;\r\n    declare protected _listenFrameEventsBase: IAnimateFrameEventOption;\r\n\tprotected _listenFrameEvents: IAnimateFrameEventOption;\r\n\r\n\t/**\r\n\t * When the last frame of the timeline is reached.\r\n\t * \r\n\t * @event\r\n\t */\r\n\tendAnimation?(e: AnimateEvent): void {}\r\n\t\r\n\t/**\r\n\t * When either labels is reached.\r\n\t * \r\n\t * @event\r\n\t */\r\n\treachLabel?(e: AnimateReachLabelEvent): void {}\r\n\r\n\tconstructor(...args: any[]) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._pixiData = createPixiMovieClipData(this);\r\n\t\tthis._createjsParams = createCreatejsMovieClipParams();\r\n\t\tthis._createjsEventManager = new CreatejsEventManager(this);\r\n\t\tP.apply(this, args);\r\n\t\tthis.framerate = this._framerateBase;\r\n        this._listenFrameEvents = Object.assign({}, this._listenFrameEventsBase || {});\r\n\t}\r\n\t\r\n\tinitialize(...args: any[]) {\r\n\t\tthis._pixiData = createPixiMovieClipData(this);\r\n\t\tthis._createjsParams = createCreatejsMovieClipParams();\r\n\t\tthis._createjsEventManager = new CreatejsEventManager(this);\r\n\t\tsuper.initialize(...args);\r\n\t\tthis.framerate = this._framerateBase;\r\n        this._listenFrameEvents = Object.assign({}, this._listenFrameEventsBase || {});\r\n\t}\r\n\r\n    /**\r\n     * 指定のカスタムイベントを `listen` するかどうかを変更します。\r\n     */\r\n    listenCustomFrameEvent(type: keyof IAnimateFrameEventOption, value: boolean) {\r\n        this._listenFrameEvents[type] = value;\r\n    }\r\n\t\r\n\tupdateForPixi(e: ITickerData): boolean {\r\n\t\tconst currentFrame = this.currentFrame;\r\n\t\t\r\n\t\t// challenge\r\n\t\tif (!this.paused) {\r\n\t\t\tthis.advance(T * e.delta);\r\n\t\t\t\r\n\t\t\tif (this._listenFrameEvents && currentFrame !== this.currentFrame) {\r\n\t\t\t\tif (this._listenFrameEvents.endAnimation && this.currentFrame === (this.totalFrames - 1)) {\r\n\t\t\t\t\tthis.dispatchEvent(new AnimateEvent('endAnimation'));\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif (this._listenFrameEvents.reachLabel) {\r\n\t\t\t\t\tfor (let i = 0; i < this.labels.length; i++) {\r\n\t\t\t\t\t\tconst label = this.labels[i];\r\n\t\t\t\t\t\tif (this.currentFrame === label.position) {\r\n\t\t\t\t\t\t\tthis.dispatchEvent(new AnimateReachLabelEvent('reachLabel', label));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis._updateState();\r\n\t\t}\r\n\t\treturn updateDisplayObjectChildren(this, e);\r\n\t}\r\n\r\n\tupdateBlendModeForPixi(mode: PIXI.BLEND_MODES): void {\r\n\t\tif (this._createjsParams.compositeOperation && blendModes[this._createjsParams.compositeOperation] === mode) return;\r\n\t\tthis._pixiData.reservedBlendMode = mode;\r\n\t\tfor (let i = 0; i < this.children.length; i++) {\r\n\t\t\tthis.children[i].updateBlendModeForPixi(mode);\r\n\t\t}\r\n\t}\r\n\r\n\tget compositeOperation() {\r\n\t\treturn this._createjsParams.compositeOperation;\r\n\t}\r\n\r\n\tset compositeOperation(value) {\r\n\t\tif (this._createjsParams.compositeOperation === value) return;\r\n\r\n\t\tconst blendMode = (value && blendModes[value]) || this._pixiData.reservedBlendMode;\r\n\t\tthis.updateBlendModeForPixi(blendMode);\r\n\t\tthis._createjsParams.compositeOperation = value;\r\n\t}\r\n\t\r\n\tget filters() {\r\n\t\treturn this._createjsParams.filters;\r\n\t}\r\n\t\r\n\t//*\r\n\tset filters(value: TCreatejsColorFilters) {\r\n\t\tconst list: PixiColorMatrixFilter[] = [];\r\n\r\n\t\tif (value && value.length > 0) {\r\n\t\t\tfor (var i = 0; i < value.length; i++) {\r\n\t\t\t\tlet f = value[i];\r\n\t\t\t\t\r\n\t\t\t\tif (!(f instanceof createjs.ColorFilter)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlist.push(f.pixi);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis._pixiData.instance.filters = list;\r\n\t\tthis._createjsParams.filters = value;\r\n\t}\r\n\t//*/\r\n\t/*\r\n\tset filters(value: TCreatejsColorFilters) {\r\n\t\tif (value) {\r\n\t\t\tconst list = [];\r\n\t\t\t\r\n\t\t\tfor (var i = 0; i < value.length; i++) {\r\n\t\t\t\tconst f = value[i];\r\n\t\t\t\t\r\n\t\t\t\tif (f instanceof createjs.ColorMatrixFilter) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconst m = new filters.ColorMatrixFilter();\r\n\t\t\t\tm.matrix = [\r\n\t\t\t\t\tf.redMultiplier, 0, 0, 0, f.redOffset / 255,\r\n\t\t\t\t\t0, f.greenMultiplier, 0, 0, f.greenOffset / 255,\r\n\t\t\t\t\t0, 0, f.blueMultiplier, 0, f.blueOffset / 255,\r\n\t\t\t\t\t0, 0, 0, f.alphaMultiplier, f.alphaOffset / 255,\r\n\t\t\t\t\t0, 0, 0, 0, 1\r\n\t\t\t\t];\r\n\t\t\t\tlist.push(m);\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i = 0; i < value.length; i++) {\r\n\t\t\t\tlet f = value[i];\r\n\t\t\t\t\r\n\t\t\t\tif (!(f instanceof createjs.ColorFilter)) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tlist.push(f.pixi);\r\n\t\t\t}\r\n\r\n\t\t\tvar o = this._pixiData.instance;\r\n\t\t\tvar c = o.children;\r\n\t\t\tvar n = new Container();\r\n\t\t\tvar nc = this._pixiData.subInstance = n.addChild(new Container());\r\n\t\t\t\r\n\t\t\twhile (c.length) {\r\n\t\t\t\tnc.addChild(c[0]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\to.addChild(n);\r\n\t\t\to.filterContainer = nc;\r\n\t\t\t\r\n\t\t\tnc.updateTransform();\r\n\t\t\tnc.calculateBounds();\r\n\t\t\t\r\n\t\t\tconst b = nc.getLocalBounds();\r\n\t\t\tconst x = b.x;\r\n\t\t\tconst y = b.y;\r\n\t\t\t\r\n\t\t\tfor (var i = 0; i < nc.children.length; i++) {\r\n\t\t\t\tconst child = nc.children[i];\r\n\t\t\t\t\r\n\t\t\t\tchild.x -= x;\r\n\t\t\t\tchild.y -= y;\r\n\t\t\t\t\r\n\t\t\t\tif (child instanceof PixiMovieClip) {\r\n\t\t\t\t\tconst fc = child.filterContainer;\r\n\t\t\t\t\tif (fc) {\r\n\t\t\t\t\t\t//fc.cacheAsBitmap = false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tn.x = x;\r\n\t\t\tn.y = y;\r\n\t\t\t\r\n\t\t\tnc.filters = list;\r\n\t\t\t//nc.cacheAsBitmap = true;\r\n\t\t} else {\r\n\t\t\tconst o = this._pixiData.instance;\r\n\t\t\t\r\n\t\t\tif (o.filterContainer) {\r\n\t\t\t\tconst nc = this._pixiData.subInstance;\r\n\t\t\t\tconst n = nc.parent;\r\n\t\t\t\tconst c = nc.children;\r\n\t\t\t\t\r\n\t\t\t\to.removeChildren();\r\n\t\t\t\to.filterContainer = null;\r\n\t\t\t\twhile (c.length) {\r\n\t\t\t\t\tconst v = o.addChild(c[0]);\r\n\t\t\t\t\tv.x += n.x;\r\n\t\t\t\t\tv.y += n.y;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tnc.filters = [];\r\n\t\t\t\t//nc.cacheAsBitmap = false;\r\n\t\t\t\t\r\n\t\t\t\tthis._pixiData.subInstance = o;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tthis._createjsParams.filters = value;\r\n\t}\r\n\t//*/\r\n\r\n\tprivate _updateChildrenBlendModeForPixi(child: ICreatejsDisplayObjectUpdater) {\r\n\t\tconst blendMode = (this._createjsParams.compositeOperation && blendModes[this._createjsParams.compositeOperation]) || this._pixiData.reservedBlendMode;\r\n\t\tif (!blendMode) return;\r\n\t\tchild.updateBlendModeForPixi(blendMode);\r\n\t}\r\n\t\r\n\taddChild(child: ICreatejsDisplayObjectUpdater) {\r\n\t\tthis._pixiData.subInstance.addChild(child.pixi);\r\n\t\tthis._updateChildrenBlendModeForPixi(child);\r\n\r\n\t\treturn super.addChild(child);\r\n\t}\r\n\t\r\n\taddChildAt(child: ICreatejsDisplayObjectUpdater, index: number) {\r\n\t\tthis._pixiData.subInstance.addChildAt(child.pixi, index);\r\n\t\tthis._updateChildrenBlendModeForPixi(child);\r\n\t\t\r\n\t\treturn super.addChildAt(child, index);\r\n\t}\r\n\t\r\n\tremoveChild(child: ICreatejsDisplayObjectUpdater) {\r\n\t\tthis._pixiData.subInstance.removeChild(child.pixi);\r\n\t\t\r\n\t\treturn super.removeChild(child);\r\n\t}\r\n\t\r\n\tremoveChildAt(index: number) {\r\n\t\tthis._pixiData.subInstance.removeChildAt(index);\r\n\t\t\r\n\t\treturn super.removeChildAt(index);\r\n\t}\r\n\t\r\n\tremoveAllChldren() {\r\n\t\tthis._pixiData.subInstance.removeChildren();\r\n\t\t\r\n\t\treturn super.removeAllChldren();\r\n\t}\r\n}\r\n\r\ndelete(CreatejsMovieClip.prototype.endAnimation);\r\ndelete(CreatejsMovieClip.prototype.reachLabel);\r\n\r\n// temporary prototype\r\nObject.defineProperties(CreatejsMovieClip.prototype, {\r\n\t_createjsParams: {\r\n\t\tvalue: createCreatejsMovieClipParams(),\r\n\t\twritable: true\r\n\t},\r\n\t_pixiData: {\r\n\t\tvalue: createPixiMovieClipData(createObject<CreatejsMovieClip>(CreatejsMovieClip.prototype)),\r\n\t\twritable: true\r\n\t}\r\n});\r\n\r\n","import { Sprite, Texture, BaseTexture } from 'pixi.js';\r\nimport createjs from '@tawaship/createjs-module';\r\nimport { mixinCreatejsDisplayObject, createPixiData, createCreatejsParams, IPixiData, ICreatejsParam, ITickerData, ICreatejsDisplayObjectUpdater, ICreatejsDisplayObjectInitializer } from './core';\r\nimport { createObject } from './utils';\r\nimport { CreatejsEventManager } from './EventManager';\r\n\r\n/**\r\n * inherited {@link http://pixijs.download/v5.3.2/docs/PIXI.Sprite.html | PIXI.Sprite}\r\n */\r\nexport class PixiSprite extends Sprite {\r\n\tprivate _createjs: CreatejsSprite | {};\r\n\t\r\n\tconstructor(cjs: CreatejsSprite | {}) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._createjs = cjs;\r\n\t}\r\n\t\r\n\tget createjs() {\r\n\t\treturn this._createjs;\r\n\t}\r\n}\r\n\r\nexport interface ICreatejsSpriteParam extends ICreatejsParam {\r\n\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createCreatejsSpriteParams(): ICreatejsSpriteParam {\r\n\treturn createCreatejsParams();\r\n}\r\n\r\nexport interface IPixiSpriteData extends IPixiData<PixiSprite> {\r\n\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createPixiSpriteData(cjs: CreatejsSprite | {}): IPixiSpriteData {\r\n\tconst pixi = new PixiSprite(cjs);\r\n\t\r\n\treturn createPixiData<PixiSprite>(pixi, pixi.anchor)\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst P = createjs.Sprite;\r\n\r\n/**\r\n * inherited {@link https://createjs.com/docs/easeljs/classes/Sprite.html | createjs.Sprite}\r\n */\r\nexport class CreatejsSprite extends mixinCreatejsDisplayObject<PixiSprite, ICreatejsSpriteParam>(createjs.Sprite) implements ICreatejsDisplayObjectUpdater, ICreatejsDisplayObjectInitializer {\r\n\tprotected _pixiData: IPixiSpriteData;\r\n\tprotected _createjsParams: ICreatejsSpriteParam;\r\n\tprotected _createjsEventManager: CreatejsEventManager;\r\n\t\r\n\tconstructor(...args: any[]) {\r\n\t\tsuper(...args);\r\n\t\t\r\n\t\tthis._pixiData = createPixiSpriteData(this);\r\n\t\tthis._createjsParams = createCreatejsSpriteParams();\r\n\t\tthis._createjsEventManager = new CreatejsEventManager(this);\r\n\t\t\r\n\t\tP.apply(this, args);\r\n\t}\r\n\t\r\n\tinitialize(...args: any[]) {\r\n\t\tthis._pixiData = createPixiSpriteData(this);\r\n\t\tthis._createjsParams = createCreatejsSpriteParams();\r\n\t\tthis._createjsEventManager = new CreatejsEventManager(this);\r\n\t\t\r\n\t\treturn super.initialize(...args);\r\n\t}\r\n\t\r\n\tupdateForPixi(e: ITickerData) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tupdateBlendModeForPixi(mode: PIXI.BLEND_MODES): void {\r\n\t\tthis._pixiData.instance.blendMode = mode;\r\n\t}\r\n\t\r\n\tgotoAndStop(...args: any[]) {\r\n\t\tsuper.gotoAndStop(...args);\r\n\t\t\r\n\t\tconst frame = this.spriteSheet.getFrame(this.currentFrame);\r\n\t\tconst baseTexture = BaseTexture.from(frame.image);\r\n\t\tconst texture = new Texture(baseTexture, frame.rect);\r\n\t\t\r\n\t\tthis._pixiData.instance.texture = texture;\r\n\t}\r\n}\r\n\r\n// temporary prototype\r\nObject.defineProperties(CreatejsSprite.prototype, {\r\n\t_createjsParams: {\r\n\t\tvalue: createCreatejsSpriteParams(),\r\n\t\twritable: true\r\n\t},\r\n\t_pixiData: {\r\n\t\tvalue: createPixiSpriteData(createObject<CreatejsSprite>(CreatejsSprite.prototype)),\r\n\t\twritable: true\r\n\t}\r\n});","import { DisplayObject, Container } from 'pixi.js';\r\nimport createjs from '@tawaship/createjs-module';\r\nimport { mixinCreatejsDisplayObject, createPixiData, createCreatejsParams, IPixiData, ICreatejsParam, ITickerData, ICreatejsDisplayObjectUpdater, ICreatejsDisplayObjectInitializer } from './core';\r\nimport { CreatejsGraphics } from './Graphics';\r\nimport { createObject } from './utils';\r\nimport { CreatejsEventManager } from './EventManager';\r\n\r\n/**\r\n * inherited {@link http://pixijs.download/v5.3.2/docs/PIXI.Container.html | PIXI.Container}\r\n */\r\nexport class PixiShape extends Container {\r\n\tprivate _createjs: CreatejsShape;\r\n\t\r\n\tconstructor(cjs: CreatejsShape) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._createjs = cjs;\r\n\t}\r\n\t\r\n\tget createjs() {\r\n\t\treturn this._createjs;\r\n\t}\r\n}\r\n\r\nexport interface ICreatejsShapeParam extends ICreatejsParam {\r\n\tgraphics: CreatejsGraphics | null;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createCreatejsShapeParams(graphics: CreatejsGraphics | null): ICreatejsShapeParam {\r\n\treturn Object.assign(createCreatejsParams(), {\r\n\t\tgraphics\r\n\t});\r\n}\r\n\r\nexport interface IPixiShapeData extends IPixiData<PixiShape> {\r\n\t/**\r\n\t * inherited {@link http://pixijs.download/v5.3.2/docs/PIXI.DisplayObject.html | PIXI.DisplayObject}\r\n\t */\r\n\tmasked: DisplayObject[];\r\n};\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createPixiShapeData(cjs: CreatejsShape) {\r\n\tconst pixi = new PixiShape(cjs);\r\n\t\r\n\treturn Object.assign(createPixiData<PixiShape>(pixi, pixi.pivot), {\r\n\t\tmasked: []\r\n\t});\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst P = createjs.Shape;\r\n\r\n/**\r\n * inherited {@link https://createjs.com/docs/easeljs/classes/Shape.html | createjs.Shape}\r\n */\r\nexport class CreatejsShape extends mixinCreatejsDisplayObject<PixiShape, ICreatejsShapeParam>(createjs.Shape) implements ICreatejsDisplayObjectUpdater, ICreatejsDisplayObjectInitializer {\r\n\tprotected _pixiData: IPixiShapeData;\r\n\tprotected _createjsParams: ICreatejsShapeParam;\r\n\tprotected _createjsEventManager: CreatejsEventManager;\r\n\t\r\n\tconstructor(...args: any[]) {\r\n\t\tsuper(...args);\r\n\t\t\r\n\t\tthis._pixiData = createPixiShapeData(this);\r\n\t\tthis._createjsParams = createCreatejsShapeParams(null);\r\n\t\tthis._createjsEventManager = new CreatejsEventManager(this);\r\n\t\t\r\n\t\tP.apply(this, args);\r\n\t}\r\n\t\r\n\tinitialize(...args: any[]) {\r\n        this._pixiData = createPixiShapeData(this);\r\n\t\tthis._createjsParams = createCreatejsShapeParams(null);\r\n\t\tthis._createjsEventManager = new CreatejsEventManager(this);\r\n\t\t\r\n\t\treturn super.initialize(...args);\r\n\t}\r\n\t\r\n\tupdateForPixi(e: ITickerData) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tupdateBlendModeForPixi(mode: PIXI.BLEND_MODES): void {\r\n\t\tthis._pixiData.reservedBlendMode = mode;\r\n\t\tthis._createjsParams.graphics?.updateBlendModeForPixi(mode);\r\n\t}\r\n\t\r\n\tget graphics() {\r\n\t\treturn this._createjsParams.graphics;\r\n\t}\r\n\t\r\n\tset graphics(value) {\r\n        if (this._pixiData !== defaultPixiData) {\r\n            if (this._pixiData.masked.length) {\r\n                this._pixiData.instance.removeChildren();\r\n                \r\n                if (value) {\r\n                    for (let i = 0; i < this._pixiData.masked.length; i++) {\r\n                        this._pixiData.masked[i].mask = this._pixiData.instance;\r\n                    }\r\n                } else {\r\n                    for (let i = 0; i < this._pixiData.masked.length; i++) {\r\n                        this._pixiData.masked[i].mask = null;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (value) {\r\n                this._pixiData.instance.addChild(value.pixi);\r\n            }\r\n        }\r\n\t\t\r\n        if (this._createjsParams !== defaultCreatejsParams) {\r\n            this._createjsParams.graphics = value;\r\n        }\r\n\t}\r\n\t\r\n\tget masked() {\r\n\t\treturn this._pixiData.masked;\r\n\t}\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst defaultCreatejsParams = createCreatejsShapeParams(null);\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst defaultPixiData = createPixiShapeData(createObject<CreatejsShape>(CreatejsShape.prototype));\r\n\r\n// temporary prototype\r\nObject.defineProperties(CreatejsShape.prototype, {\r\n\t_createjsParams: {\r\n\t\tvalue: defaultCreatejsParams,\r\n\t\twritable: true\r\n\t},\r\n\t_pixiData: {\r\n\t\tvalue: defaultPixiData,\r\n\t\twritable: true\r\n\t}\r\n});","import { Sprite, Texture } from 'pixi.js';\r\nimport createjs from '@tawaship/createjs-module';\r\nimport { mixinCreatejsDisplayObject, createPixiData, createCreatejsParams, IPixiData, ICreatejsParam, ITickerData, ICreatejsDisplayObjectUpdater, ICreatejsDisplayObjectInitializer } from './core';\r\nimport { createObject } from './utils';\r\nimport { CreatejsEventManager } from './EventManager';\r\n\r\n/**\r\n * inherited {@link http://pixijs.download/v5.3.2/docs/PIXI.Sprite.html | PIXI.Sprite}\r\n */\r\nexport class PixiBitmap extends Sprite {\r\n\tprivate _createjs: CreatejsBitmap;\r\n\t\r\n\tconstructor(cjs: CreatejsBitmap) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._createjs = cjs;\r\n\t}\r\n\t\r\n\tget createjs() {\r\n\t\treturn this._createjs;\r\n\t}\r\n}\r\n\r\nexport interface ICreatejsBitmapParam extends ICreatejsParam {\r\n\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createCreatejsBitmapParams(): ICreatejsBitmapParam {\r\n\treturn createCreatejsParams();\r\n}\r\n\r\nexport interface IPixiBitmapData extends IPixiData<PixiBitmap> {\r\n\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createPixiBitmapData(cjs: CreatejsBitmap): IPixiBitmapData {\r\n\tconst pixi = new PixiBitmap(cjs);\r\n\t\r\n\treturn createPixiData<PixiBitmap>(pixi, pixi.anchor);\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst P = createjs.Bitmap;\r\n\r\n/**\r\n * inherited {@link https://createjs.com/docs/easeljs/classes/Bitmap.html | createjs.Bitmap}\r\n */\r\nexport class CreatejsBitmap extends mixinCreatejsDisplayObject<PixiBitmap, ICreatejsBitmapParam>(createjs.Bitmap) implements ICreatejsDisplayObjectUpdater, ICreatejsDisplayObjectInitializer {\r\n\tprotected _pixiData: IPixiBitmapData;\r\n\tprotected _createjsParams: ICreatejsBitmapParam;\r\n\tprotected _createjsEventManager: CreatejsEventManager;\r\n\t \r\n\tconstructor(...args: any[]) {\r\n\t\tsuper(...args);\r\n\t\t\r\n\t\tthis._pixiData = createPixiBitmapData(this);\r\n\t\tthis._createjsParams = createCreatejsBitmapParams();\r\n\t\tthis._createjsEventManager = new CreatejsEventManager(this);\r\n\t\t\r\n\t\tP.apply(this, args);\r\n\t}\r\n\t\r\n\tinitialize(...args: any[]) {\r\n\t\tthis._pixiData = createPixiBitmapData(this);\r\n\t\tthis._createjsParams = createCreatejsBitmapParams();\r\n\t\tthis._createjsEventManager = new CreatejsEventManager(this);\r\n\t\t\r\n\t\tconst res = super.initialize(...args);\r\n\t\tconst texture = Texture.from(this.image);\r\n\t\tthis._pixiData.instance.texture = texture;\r\n\t\t\r\n\t\treturn res;\r\n\t}\r\n\t\r\n\tupdateForPixi(e: ITickerData) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tupdateBlendModeForPixi(mode: PIXI.BLEND_MODES): void {\r\n\t\tthis._pixiData.instance.blendMode = mode;\r\n\t}\r\n}\r\n\r\n// temporary prototype\r\nObject.defineProperties(CreatejsBitmap.prototype, {\r\n\t_createjsParams: {\r\n\t\tvalue: createCreatejsBitmapParams(),\r\n\t\twritable: true\r\n\t},\r\n\t_pixiData: {\r\n\t\tvalue: createPixiBitmapData(createObject<CreatejsBitmap>(CreatejsBitmap.prototype)),\r\n\t\twritable: true\r\n\t}\r\n});\r\n","import { Graphics, LINE_CAP, LINE_JOIN} from 'pixi.js';\r\nimport createjs from '@tawaship/createjs-module';\r\nimport { mixinCreatejsDisplayObject, createPixiData, createCreatejsParams, IPixiData, ICreatejsParam,  ITickerData, ICreatejsDisplayObjectUpdater, ICreatejsDisplayObjectInitializer } from './core';\r\nimport { createObject, DEG_TO_RAD } from './utils';\r\nimport { CreatejsEventManager } from './EventManager';\r\n\r\n/**\r\n * inherited {@link http://pixijs.download/v5.3.2/docs/PIXI.Graphics.html | PIXI.Graphics}\r\n */\r\nexport class PixiGraphics extends Graphics {\r\n\tprivate _createjs: CreatejsGraphics;\r\n\t\r\n\tconstructor(cjs: CreatejsGraphics) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._createjs = cjs;\r\n\t}\r\n\t\r\n\tget createjs() {\r\n\t\treturn this._createjs;\r\n\t}\r\n}\r\n\r\nexport interface ICreatejsGraphicsParam extends ICreatejsParam {\r\n\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createCreatejsGraphicsParams(): ICreatejsGraphicsParam {\r\n\treturn createCreatejsParams();\r\n}\r\n\r\nexport interface IPixiGraphicsData extends IPixiData<PixiGraphics> {\r\n\tstrokeFill: number;\r\n\tstrokeAlpha: number;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createPixiGraphicsData(cjs: CreatejsGraphics): IPixiGraphicsData {\r\n\tconst pixi = new PixiGraphics(cjs);\r\n\t\r\n\treturn Object.assign(createPixiData<PixiGraphics>(pixi, pixi.pivot), {\r\n\t\tstrokeFill: 0,\r\n\t\tstrokeAlpha: 1\r\n\t});\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst COLOR_RED = 16 * 16 * 16 * 16;\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst COLOR_GREEN = 16 * 16;\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst LineCap = {\r\n\t0: LINE_CAP.BUTT,\r\n\t1: LINE_CAP.ROUND,\r\n\t2: LINE_CAP.SQUARE\r\n};\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst LineJoin = {\r\n\t0: LINE_JOIN.MITER,\r\n\t1: LINE_JOIN.ROUND,\r\n\t2: LINE_JOIN.BEVEL\r\n};\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst P = createjs.Graphics;\r\n\r\n/**\r\n * inherited {@link https://createjs.com/docs/easeljs/classes/Graphics.html | createjs.Graphics}\r\n */\r\nexport class CreatejsGraphics extends mixinCreatejsDisplayObject<PixiGraphics, ICreatejsGraphicsParam>(createjs.Graphics) implements ICreatejsDisplayObjectUpdater, ICreatejsDisplayObjectInitializer {\r\n\tprotected _pixiData: IPixiGraphicsData;\r\n\tprotected _createjsParams: ICreatejsGraphicsParam;\r\n\tprotected _createjsEventManager: CreatejsEventManager;\r\n\t\r\n\tconstructor(...args: any[]) {\r\n\t\tsuper(...args);\r\n\t\t\r\n\t\tthis._pixiData = createPixiGraphicsData(this);\r\n\t\tthis._createjsParams = createCreatejsGraphicsParams();\r\n\t\tthis._createjsEventManager = new CreatejsEventManager(this);\r\n\t\t\r\n\t\tP.apply(this, args);\r\n\t\t\r\n\t\tthis._pixiData.instance.beginFill(0xFFEEEE, 1);\r\n\t\tthis._pixiData.strokeFill = 0;\r\n\t\tthis._pixiData.strokeAlpha = 1;\r\n\t}\r\n\t\r\n\tinitialize(...args: any[]) {\r\n\t\tthis._pixiData = createPixiGraphicsData(this);\r\n\t\tthis._createjsParams = createCreatejsGraphicsParams();\r\n\t\tthis._createjsEventManager = new CreatejsEventManager(this);\r\n\t\t\r\n\t\treturn super.initialize(...args);\r\n\t}\r\n\t\r\n\tupdateForPixi(e: ITickerData) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tupdateBlendModeForPixi(mode: PIXI.BLEND_MODES): void {\r\n\t\tif (!mode) return;\r\n\t\tthis._pixiData.instance.blendMode = mode;\r\n\t}\r\n\t\r\n\t// path methods\r\n\t\r\n\tmoveTo(x: number, y: number) {\r\n\t\tif (this._pixiData.instance.clone().endFill().containsPoint({x: x, y: y})) {\r\n\t\t\tthis._pixiData.instance.beginHole();\r\n\t\t} else {\r\n\t\t\tthis._pixiData.instance.endHole();\r\n\t\t}\r\n\t\t\r\n\t\tthis._pixiData.instance.moveTo(x, y);\r\n\t\t\r\n\t\treturn super.moveTo(x, y);\r\n\t}\r\n\t\r\n\tmt(x: number, y: number) {\r\n\t\treturn this.moveTo(x, y);\r\n\t}\r\n\t\r\n\tlineTo(x: number, y: number) {\r\n\t\tthis._pixiData.instance.lineTo(x, y);\r\n\t\t\r\n\t\treturn super.lineTo(x, y);\r\n\t}\r\n\t\r\n\tlt(x: number, y: number) {\r\n\t\treturn this.lineTo(x, y);\r\n\t}\r\n\t\r\n\tarcTo(x1: number, y1: number, x2: number, y2: number, radius: number) {\r\n\t\tthis._pixiData.instance.arcTo(x1, y1, x2, y2, radius);\r\n\t\t\r\n\t\treturn super.arcTo(x1, y1, x2, y2, radius);\r\n\t}\r\n\t\r\n\tat(x1: number, y1: number, x2: number, y2: number, radius: number) {\r\n\t\treturn this.arcTo(x1, y1, x2, y2, radius);\r\n\t}\r\n\t\r\n\tarc(x: number, y: number, radius: number, startAngle: number, endAngle: number, anticlockwise: boolean) {\r\n\t\tthis._pixiData.instance.arc(x, y, radius, startAngle, endAngle, anticlockwise);\r\n\t\t\r\n\t\treturn super.arc(x, y, radius, startAngle, endAngle, anticlockwise);\r\n\t}\r\n\t\r\n\ta(x: number, y: number, radius: number, startAngle: number, endAngle: number, anticlockwise: boolean) {\r\n\t\treturn this.arc(x, y, radius, startAngle, endAngle, anticlockwise);\r\n\t}\r\n\t\r\n\tquadraticCurveTo(cpx: number, cpy: number, x: number, y: number) {\r\n\t\tthis._pixiData.instance.quadraticCurveTo(cpx, cpy, x, y);\r\n\t\t\r\n\t\treturn super.quadraticCurveTo(cpx, cpy, x, y);\r\n\t}\r\n\t\r\n\tqt(cpx: number, cpy: number, x: number, y: number) {\r\n\t\treturn this.quadraticCurveTo(cpx, cpy, x, y);\r\n\t}\r\n\t\r\n\tcurveTo(cpx: number, cpy: number, x: number, y: number) {\r\n\t\treturn this.quadraticCurveTo(cpx, cpy, x, y);\r\n\t}\r\n\t\r\n\tbezierCurveTo(cp1x: number, cp1y: number, cp2x: number, cp2y: number, x: number, y: number) {\r\n\t\tthis._pixiData.instance.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);\r\n\t\t\r\n\t\treturn super.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);\r\n\t}\r\n\t\r\n\tbt(cp1x: number, cp1y: number, cp2x: number, cp2y: number, x: number, y: number) {\r\n\t\treturn this.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);\r\n\t}\r\n\t\r\n\trect(x: number, y: number, w: number, h: number) {\r\n\t\tthis._pixiData.instance.drawRect(x, y, w, h);\r\n\t\t\r\n\t\treturn super.rect(x, y, w, h);\r\n\t}\r\n\t\r\n\tr(x: number, y: number, w: number, h: number) {\r\n\t\treturn this.rect(x, y, w, h);\r\n\t}\r\n\t\r\n\tdrawRect(x: number, y: number, w: number, h: number) {\r\n\t\treturn this.rect(x, y, w, h);\r\n\t}\r\n\t\r\n\tdr(x: number, y: number, w: number, h: number) {\r\n\t\treturn this.rect(x, y, w, h);\r\n\t}\r\n\t\r\n\tclosePath() {\r\n\t\tthis._pixiData.instance.closePath();\r\n\t\t\r\n\t\treturn super.closePath();\r\n\t}\r\n\t\r\n\tcp() {\r\n\t\treturn this.closePath();\r\n\t}\r\n\t\r\n\tclear() {\r\n\t\tthis._pixiData.instance.clear();\r\n\t\t\r\n\t\treturn super.clear();\r\n\t}\r\n\t\r\n\tc() {\r\n\t\treturn this.clear();\r\n\t}\r\n\t\r\n\tprivate _parseColor(color: string) {\r\n\t\tconst res = {\r\n\t\t\tcolor: 0,\r\n\t\t\talpha: 1\r\n\t\t};\r\n\t\t\r\n\t\tif (!color) {\r\n\t\t\tres.alpha = 0;\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\t\r\n\t\tif (color.charAt(0) === '#') {\r\n\t\t\tres.color = parseInt(color.slice(1), 16);\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\t\r\n\t\tconst colors = color.replace(/rgba|\\(|\\)|\\s/g, '').split(',');\r\n\t\t\r\n\t\tres.color = Number(colors[0]) * COLOR_RED + Number(colors[1]) * COLOR_GREEN + Number(colors[2]);\r\n\t\tres.alpha = Number(colors[3]);\r\n\t\t\r\n\t\treturn res;\r\n\t}\r\n\t\r\n\tbeginFill(color: string) {\r\n\t\tconst c = this._parseColor(color);\r\n\t\tthis._pixiData.instance.beginFill(c.color, c.alpha);\r\n\t\t\r\n\t\treturn super.beginFill(color);\r\n\t}\r\n\t\r\n\tf(color: string) {\r\n\t\treturn this.beginFill(color);\r\n\t}\r\n\t\r\n\tendFill() {\r\n\t\tthis._pixiData.instance.endFill();\r\n\t\t\r\n\t\treturn super.endFill();\r\n\t}\r\n\t\r\n\tef() {\r\n\t\treturn this.endFill();\r\n\t}\r\n\t\r\n\tsetStrokeStyle(thickness: number, caps: 0 | 1 | 2, joints: 0 | 1 | 2, miterLimit: number, ignoreScale: boolean) {\r\n\t\tthis._pixiData.instance.lineTextureStyle({\r\n\t\t\twidth: thickness,\r\n\t\t\tcolor: this._pixiData.strokeFill,\r\n\t\t\talpha: this._pixiData.strokeAlpha,\r\n\t\t\tcap: (caps in LineCap) ? LineCap[caps] : LineCap[0],\r\n\t\t\tjoin: (joints in LineJoin) ? LineJoin[joints] : LineJoin[0],\r\n\t\t\tmiterLimit\r\n\t\t});\r\n\t\t\r\n\t\treturn super.setStrokeStyle(thickness, caps, joints, miterLimit, ignoreScale);\r\n\t}\r\n\t\r\n\tss(thickness: number, caps: 0 | 1 | 2, joints: 0 | 1 | 2, miterLimit: number, ignoreScale: boolean) {\r\n\t\treturn this.setStrokeStyle(thickness, caps, joints, miterLimit, ignoreScale);\r\n\t}\r\n\t\r\n\tbeginStroke(color: string) {\r\n\t\tconst c = this._parseColor(color);\r\n\t\tthis._pixiData.strokeFill = c.color;\r\n\t\tthis._pixiData.strokeAlpha = c.alpha;\r\n\t\t\r\n\t\treturn super.beginStroke(color);\r\n\t}\r\n\t\r\n\ts(color: string) {\r\n\t\treturn this.beginStroke(color);\r\n\t}\r\n\t\r\n\tdrawRoundRect(x: number, y: number, w: number, h: number, radius: number) {\r\n\t\tthis._pixiData.instance.drawRoundedRect(x, y, w, h, radius);\r\n\t\t\r\n\t\treturn super.drawRoundRect(x, y, w, h, radius);\r\n\t}\r\n\t\r\n\trr(x: number, y: number, w: number, h: number, radius: number) {\r\n\t\treturn this.drawRoundRect(x, y, w, h, radius);\r\n\t}\r\n\t\r\n\tdrawCircle(x: number, y: number, radius: number) {\r\n\t\tthis._pixiData.instance.drawCircle(x, y, radius);\r\n\t\t\r\n\t\treturn super.drawCircle(x, y, radius);\r\n\t}\r\n\t\r\n\tdc(x: number, y: number, radius: number) {\r\n\t\treturn this.drawCircle(x, y, radius);\r\n\t}\r\n\t\r\n\tdrawEllipse(x: number, y: number, w: number, h: number) {\r\n\t\tthis._pixiData.instance.drawEllipse(x, y, w, h);\r\n\t\t\r\n\t\treturn super.drawEllipse(x, y, w, h);\r\n\t}\r\n\t\r\n\tde(x: number, y: number, w: number, h: number) {\r\n\t\treturn this.drawEllipse(x, y, w, h);\r\n\t}\r\n\t\r\n\tdrawPolyStar(x: number, y: number, radius: number, sides: number, pointSize: number, angle: number) {\r\n\t\tthis._pixiData.instance.drawRegularPolygon(x, y, radius, sides, angle * DEG_TO_RAD);\r\n\t\t\r\n\t\treturn super.drawPolyStar(x, y, radius, sides, pointSize, angle);\r\n\t}\r\n\t\r\n\tdp(x: number, y: number, radius: number, sides: number, pointSize: number, angle: number) {\r\n\t\treturn this.drawPolyStar(x, y, radius, sides, pointSize, angle);\r\n\t}\r\n}\r\n\r\n// temporary prototype\r\nObject.defineProperties(CreatejsGraphics.prototype, {\r\n\t_createjsParams: {\r\n\t\tvalue: createCreatejsGraphicsParams(),\r\n\t\twritable: true\r\n\t},\r\n\t_pixiData: {\r\n\t\tvalue: createPixiGraphicsData(createObject<CreatejsGraphics>(CreatejsGraphics.prototype)),\r\n\t\twritable: true\r\n\t}\r\n});","import { Container, Text } from 'pixi.js';\r\nimport createjs from '@tawaship/createjs-module';\r\nimport { mixinCreatejsDisplayObject, createPixiData, createCreatejsParams, IPixiData, ICreatejsParam, ITickerData, ICreatejsDisplayObjectUpdater } from './core';\r\nimport { createObject } from './utils';\r\nimport { CreatejsEventManager } from './EventManager';\r\n\r\n/**\r\n * inherited {@link http://pixijs.download/v5.3.2/docs/PIXI.Text.html | PIXI.Text}\r\n */\r\nexport class PixiText extends Text {}\r\n\r\n/**\r\n * inherited {@link http://pixijs.download/v5.3.2/docs/PIXI.Container.html | PIXI.Container}\r\n */\r\nexport class PixiTextContainer extends Container {\r\n\tprivate _createjs: CreatejsText;\r\n\tprivate _text: PixiText;\r\n\t\r\n\tconstructor(cjs: CreatejsText, text: PixiText) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._createjs = cjs;\r\n\t\tthis._text = text;\r\n\t}\r\n\t\r\n\tget createjs() {\r\n\t\treturn this._createjs;\r\n\t}\r\n\t\r\n\tget text() {\r\n\t\treturn this._text;\r\n\t}\r\n}\r\n\r\nexport type TCreatejsTextAlign = 'left' | 'center' | 'right';\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst DEF_ALIGN: TCreatejsTextAlign = 'left';\r\n\r\nexport interface ICreatejsTextParam extends ICreatejsParam {\r\n\ttext: string;\r\n\tfont: string;\r\n\tcolor: string;\r\n\ttextAlign: TCreatejsTextAlign;\r\n\tlineHeight: number;\r\n\tlineWidth: number;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createCreatejsTextParams(text: string, font: string, color: string): ICreatejsTextParam {\r\n\treturn Object.assign(createCreatejsParams(), {\r\n\t\ttext: text,\r\n\t\tfont: font,\r\n\t\tcolor: color,\r\n\t\ttextAlign: DEF_ALIGN,\r\n\t\tlineHeight: 0,\r\n\t\tlineWidth: 0\r\n\t});\r\n}\r\n\r\nexport interface IPixiTextData extends IPixiData<PixiTextContainer> {\r\n\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createPixiTextData(cjs: CreatejsText, text: PixiText): IPixiTextData {\r\n\tconst pixi = new PixiTextContainer(cjs, text);\r\n\t\r\n\treturn createPixiData<PixiTextContainer>(pixi, pixi.pivot);\r\n}\r\n\r\nexport interface ICreatejsParsedText {\r\n\tfontSize: number;\r\n\tfontFamily: string;\r\n\tfontWeight?: string | number;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst P = createjs.Text;\r\n\r\n/**\r\n * inherited {@link https://createjs.com/docs/easeljs/classes/Text.html | createjs.Text}\r\n */\r\nexport class CreatejsText extends mixinCreatejsDisplayObject<PixiTextContainer, ICreatejsTextParam>(createjs.Text) implements ICreatejsDisplayObjectUpdater {\r\n\tprotected _pixiData: IPixiTextData;\r\n\tprotected _createjsParams: ICreatejsTextParam;\r\n\tprotected _createjsEventManager: CreatejsEventManager;\r\n\t\r\n\tconstructor(text: string, font: string, color: string = '#000000', ...args: any[]) {\r\n\t\tsuper(text, font, color, ...args);\r\n\t\t\r\n\t\tthis._createjsParams = createCreatejsTextParams(text, font, color);\r\n\t\t\r\n\t\tconst _font = this._parseFont(font);\r\n\t\t\r\n\t\tconst t = new PixiText(text, {\r\n\t\t\tfontWeight: _font.fontWeight,\r\n\t\t\tfontSize: _font.fontSize,\r\n\t\t\tfontFamily: _font.fontFamily,\r\n\t\t\tfill: this._parseColor(color),\r\n\t\t\twordWrap: true\r\n\t\t});\r\n\t\t\r\n\t\tthis._pixiData = createPixiTextData(this, t);\r\n\t\tthis._pixiData.instance.addChild(t);\r\n\t\t\r\n\t\tthis._createjsEventManager = new CreatejsEventManager(this);\r\n\t\t\r\n\t\tP.call(this, text, font, color, ...args);\r\n\t}\r\n\t\r\n\tupdateForPixi(e: ITickerData) {\r\n\t\treturn true;\r\n\t}\r\n\r\n\tupdateBlendModeForPixi(mode: PIXI.BLEND_MODES): void {\r\n\t\tthis._pixiData.instance.text.blendMode = mode;\r\n\t}\r\n\t\r\n\tget text() {\r\n\t\treturn this._createjsParams.text;\r\n\t}\r\n\t\r\n\tset text(text) {\r\n\t\tthis._pixiData.instance.text.text = text;\r\n\t\tthis._align(this.textAlign);\r\n\t\t\r\n\t\tthis._createjsParams.text = text;\r\n\t}\r\n\t\r\n\tprivate _parseFont(font: string): ICreatejsParsedText {\r\n\t\tconst p = font.split(' ');\r\n\t\t\r\n\t\tlet w = 'normal';\r\n\t\tlet s = p.shift() || '';\r\n\t\t\r\n\t\tif (s.indexOf('px') === -1) {\r\n\t\t\tw = s;\r\n\t\t\ts = p.shift() || '';\r\n\t\t}\r\n\t\t\r\n\t\treturn {\r\n\t\t\tfontWeight: w,\r\n\t\t\tfontSize: Number((s || '0px').replace('px', '')),\r\n\t\t\tfontFamily: p.join(' ').replace(/'/g, '') //'\r\n\t\t};\r\n\t}\r\n\t\r\n\tget font() {\r\n\t\treturn this._createjsParams.font;\r\n\t}\r\n\t\r\n\tset font(font) {\r\n\t\tconst _font = this._parseFont(font);\r\n\t\tthis._pixiData.instance.text.style.fontSize = _font.fontSize;\r\n\t\tthis._pixiData.instance.text.style.fontFamily = _font.fontFamily;\r\n\t\t\r\n\t\tthis._createjsParams.font = font;\r\n\t}\r\n\t\r\n\tprivate _parseColor(color: string) {\r\n\t\treturn parseInt(color.slice(1), 16);\r\n\t}\r\n\t\r\n\tget color() {\r\n\t\treturn this._createjsParams.color;\r\n\t}\r\n\t\r\n\tset color(color) {\r\n\t\tthis._pixiData.instance.text.style.fill = this._parseColor(color);\r\n\t\t\r\n\t\tthis._createjsParams.color = color;\r\n\t}\r\n\t\r\n\tprivate _align(align: TCreatejsTextAlign) {\r\n\t\tif (align === 'left') {\r\n\t\t\tthis._pixiData.instance.text.x = 0;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (align === 'center') {\r\n\t\t\tthis._pixiData.instance.text.x = -this._pixiData.instance.text.width / 2;\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (align === 'right') {\r\n\t\t\tthis._pixiData.instance.text.x =  -this._pixiData.instance.text.width;\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\t\r\n\tget textAlign() {\r\n\t\treturn this._createjsParams.textAlign;\r\n\t}\r\n\t\r\n\tset textAlign(align) {\r\n\t\tthis._pixiData.instance.text.style.align = align;\r\n\t\tthis._align(align);\r\n\t\t\r\n\t\tthis._createjsParams.textAlign = align;\r\n\t}\r\n\t\r\n\tget lineHeight() {\r\n\t\treturn this._createjsParams.lineHeight;\r\n\t}\r\n\t\r\n\tset lineHeight(height) {\r\n\t\tthis._pixiData.instance.text.style.lineHeight = height;\r\n\t\t\r\n\t\tthis._createjsParams.lineHeight = height;\r\n\t}\r\n\t\r\n\tget lineWidth() {\r\n\t\treturn this._createjsParams.lineWidth;\r\n\t}\r\n\t\r\n\tset lineWidth(width) {\r\n\t\tthis._pixiData.instance.text.style.wordWrapWidth = width;\r\n\t\tthis._align(this.textAlign);\r\n\t\t\r\n\t\tthis._createjsParams.lineWidth = width;\r\n\t}\r\n}\r\n\r\n// temporary prototype\r\nObject.defineProperties(CreatejsText.prototype, {\r\n\t_createjsParams: {\r\n\t\tvalue: createCreatejsTextParams('', '', ''),\r\n\t\twritable: true\r\n\t},\r\n\t_pixiData: {\r\n\t\tvalue: createPixiTextData(createObject<CreatejsText>(CreatejsText.prototype), new PixiText('')),\r\n\t\twritable: true\r\n\t}\r\n});","import { filters } from 'pixi.js';\r\nimport createjs from '@tawaship/createjs-module';\r\nimport { ICreatejsParam, createCreatejsParams } from './core';\r\nimport { createObject } from './utils';\r\n\r\n/**\r\n * inherited {@link http://pixijs.download/v5.3.2/docs/PIXI.ColorMatrixFilter.html | PIXI.Sprite}\r\n */\r\nexport class PixiColorMatrixFilter extends filters.ColorMatrixFilter {\r\n\tprivate _createjs: CreatejsColorFilter;\r\n\t\r\n\tconstructor(cjs: CreatejsColorFilter) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._createjs = cjs;\r\n\t}\r\n\t\r\n\tget createjs() {\r\n\t\treturn this._createjs;\r\n\t}\r\n}\r\n\r\nexport interface IPixiColorMatrixFilterData {\r\n\tinstance: PixiColorMatrixFilter;\r\n};\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createPixiColorMatrixFilterData(cjs: CreatejsColorFilter): IPixiColorMatrixFilterData {\r\n\tconst pixi = new PixiColorMatrixFilter(cjs);\r\n\t\r\n\treturn { instance: pixi };\r\n}\r\n\r\nexport interface ICreatejsColorFilterParam extends ICreatejsParam {\r\n\tredMultiplier: number;\r\n    greenMultiplier: number;\r\n    blueMultiplier: number;\r\n    alphaMultiplier: number;\r\n    redOffset: number;\r\n    greenOffset: number;\r\n    blueOffset: number;\r\n    alphaOffset: number;\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction createCreatejsColorFilterParams(): ICreatejsColorFilterParam {\r\n\treturn Object.assign(createCreatejsParams(), {\r\n\t\tredMultiplier: 1,\r\n        greenMultiplier: 1,\r\n        blueMultiplier: 1,\r\n        alphaMultiplier: 1,\r\n        redOffset: 0,\r\n        greenOffset: 0,\r\n        blueOffset: 0,\r\n        alphaOffset: 0\r\n\t});\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nconst P = createjs.ColorFilter;\r\n\r\n/**\r\n * inherited {@link https://createjs.com/docs/easeljs/classes/ColorFilter.html | createjs.ColorFilter}\r\n */\r\nexport class CreatejsColorFilter extends createjs.ColorFilter {\r\n    protected _pixiData: IPixiColorMatrixFilterData;\r\n    protected _createjsParams: ICreatejsColorFilterParam;\r\n\r\n    constructor(...args: number[]) {\r\n        super(args);\r\n\r\n        const pixiData = this._pixiData = createPixiColorMatrixFilterData(this);\r\n        const createjsParams = this._createjsParams = createCreatejsColorFilterParams();\r\n\r\n        // ColorFilterのtweenは、列挙可能かつ hasOwnPropery なプロパティにアクセスしてしまうので、enumerableを切っておく\r\n        Object.defineProperties(this, {\r\n            _pixiData: {\r\n                enumerable: false,\r\n                value: pixiData\r\n            },\r\n            _createjsParams: {\r\n                enumerable: false,\r\n                value: createjsParams\r\n            },\r\n            redMultiplier: {\r\n                get() {\r\n                    return this._createjsParams.redMultiplier;\r\n                },\r\n                set(value) {\r\n                    this._pixiData.instance.matrix[0] = value, this._createjsParams.redMultiplier = value;\r\n                }\r\n            },\r\n            greenMultiplier: {\r\n                get() {\r\n                    return this._createjsParams.greenMultiplier;\r\n                },\r\n                set(value) {\r\n                    this._pixiData.instance.matrix[6] = value, this._createjsParams.greenMultiplier = value;\r\n                }\r\n            },\r\n            blueMultiplier: {\r\n                get() {\r\n                    return this._createjsParams.blueMultiplier;\r\n                },\r\n                set(value) {\r\n                    this._pixiData.instance.matrix[12] = value, this._createjsParams.blueMultiplier = value;\r\n                }\r\n            },\r\n            alphaMultiplier: {\r\n                get() {\r\n                    return this._createjsParams.alphaMultiplier;\r\n                },\r\n                set(value) {\r\n                    this._pixiData.instance.matrix[18] = value, this._createjsParams.alphaMultiplier = value;\r\n                },\r\n            },\r\n            redOffset: {\r\n                get() {\r\n                    return this._createjsParams.redOffset;\r\n                },\r\n                set(value) {\r\n                    this._pixiData.instance.matrix[4] = value / 255, this._createjsParams.redOffset = value;\r\n                }\r\n            },\r\n            greenOffset: {\r\n                get() {\r\n                    return this._createjsParams.greenOffset;\r\n                },\r\n                set(value) {\r\n                    this._pixiData.instance.matrix[9] = value / 255, this._createjsParams.greenOffset = value;\r\n                }\r\n            },\r\n            blueOffset: {\r\n                get() {\r\n                    return this._createjsParams.blueOffset;\r\n                },\r\n                set(value) {\r\n                    this._pixiData.instance.matrix[14] = value / 255, this._createjsParams.blueOffset = value;\r\n                }\r\n            },\r\n            alphaOffset: {\r\n                get() {\r\n                    return this._createjsParams.alphaOffset;\r\n                },\r\n                set(value) {\r\n                    this._pixiData.instance.matrix[19] = value / 255, this._createjsParams.alphaOffset = value;\r\n                }\r\n            }\r\n        });\r\n\r\n        P.apply(this, args);\r\n    }\r\n    \r\n    get pixi() {\r\n        return this._pixiData.instance;\r\n    }\r\n}\r\n\r\n// temporary prototype\r\nObject.defineProperties(CreatejsColorFilter.prototype, {\r\n\t_createjsParams: {\r\n\t\tvalue: createCreatejsColorFilterParams(),\r\n\t\twritable: true\r\n\t},\r\n\t_pixiData: {\r\n\t\tvalue: createPixiColorMatrixFilterData(createObject<CreatejsColorFilter>(CreatejsColorFilter.prototype)),\r\n\t\twritable: true\r\n\t}\r\n});","import * as PIXI from 'pixi.js';\r\nimport * as PA from './modules';\r\nimport createjs from '@tawaship/createjs-module';\r\n\r\ndeclare const AdobeAn: any;\r\ndeclare const window: any;\r\n\r\nexport interface IAnimateLibrary {\r\n\t[ name: string ]: any;\r\n}\r\n\r\nexport interface IAnimateLoadAssetOption {\r\n\t/**\r\n\t * Whether to use assets on a server in another domain.\r\n\t */\r\n\tcrossOrigin?: boolean;\r\n\r\n\t/**\r\n\t * Whether to use sound on createjs.\r\n\t * \r\n\t * However, if possible, try to use an external library such as ***howler.js***.\r\n\t */\r\n\tuseSound?: boolean;\r\n\r\n\t/**\r\n\t * Whether to fire events related to frames.\r\n\t */\r\n\tlistenFrameEvents?: PA.IAnimateFrameEventOption;\r\n};\r\n\r\nexport interface IAnimatePrepareTarget {\r\n\t/**\r\n\t * \"lib.properties.id\" in Animate content.\r\n\t */\r\n\tid: string;\r\n\t\r\n\t/**\r\n\t * Directory path of Animate content.\r\n\t */\r\n\tbasepath: string;\r\n\t\r\n\toptions?: IAnimateLoadAssetOption;\r\n};\r\n\r\nfunction playSound(id: string, loop: boolean, offset: number) {\r\n\treturn createjs.Sound.play(id, {\r\n\t\tinterrupt: createjs.Sound.INTERRUPT_EARLY,\r\n\t\tloop,\r\n\t\toffset\r\n\t});\r\n}\r\n\r\nexport interface IAnimateManifest {\r\n\tsrc: string;\r\n\tid: string;\r\n\ttype?: string;\r\n\tcrossOrigin?: boolean;\r\n\t[key: string]: any;\r\n}\r\n\r\n/*\r\nexport function dataURLToBlobURL(dataURL: string) {\r\n\tconst bin = atob(dataURL.replace(/^.*,/, ''));\r\n\tconst buffer = new Uint8Array(bin.length);\r\n\tfor (let i = 0; i < bin.length; i++) {\r\n\t\tbuffer[i] = bin.charCodeAt(i);\r\n\t}\r\n\r\n\tconst p = dataURL.slice(5);\r\n\ttry{\r\n\t\tconst blob = new Blob([buffer.buffer], {\r\n\t\t\ttype: p.slice(0, p.indexOf(\";\"))\r\n\t\t});\r\n\t\treturn (URL || webkitURL).createObjectURL(blob);\r\n\t} catch (e){\r\n\t\tthrow e;\r\n\t};\r\n}\r\n*/\r\n\r\n/**\r\n * Load the assets of createjs content published by Adobe Animate.\r\n * If you use multiple contents, each composition ID must be unique.\r\n * Please run \"Pixim.animate.init\" before running.\r\n */\r\nexport function loadAssetAsync(targets: IAnimatePrepareTarget | IAnimatePrepareTarget[]) {\r\n\tif (!Array.isArray(targets)) {\r\n\t\ttargets = [targets];\r\n\t}\r\n\t\r\n\tconst promises: Promise<IAnimateLibrary>[] = [];\r\n\r\n\tfor (let i = 0; i < targets.length; i++) {\r\n\t\tconst target = targets[i];\r\n\r\n\t\tif (target.options?.useSound) {\r\n\t\t\twindow.playSound = playSound;\r\n\t\t}\r\n\t\t\r\n\t\tconst comp = AdobeAn.getComposition(target.id);\r\n\t\tif (!comp) {\r\n\t\t\tthrow new Error(`no composition: ${target.id}`);\r\n\t\t}\r\n\t\t\r\n\t\tconst lib: IAnimateLibrary = comp.getLibrary();\r\n\t\tconst manifests: IAnimateManifest[] = lib.properties.manifest.map((v: any) => {\r\n\t\t\treturn JSON.parse(JSON.stringify(v));\r\n\t\t});\r\n\t\tconst crossOrigin = typeof(target.options?.crossOrigin) === 'boolean' ? target.options.crossOrigin : true;\r\n\t\t\r\n\t\tfor (let i = 0; i < manifests.length; i++) {\r\n\t\t\tconst manifest = manifests[i];\r\n\t\t\tif (manifest.src.indexOf('data:image') === 0) {\r\n\t\t\t\tmanifest.type = createjs.Types.IMAGE;\r\n\t\t\t} else if (manifest.src.indexOf('data:audio') === 0) {\r\n\t\t\t\t/* note\r\n\t\t\t\t\tIt seems that data URL format sounds are not supported by the createjs loader.\r\n\t\t\t\t\tConverting to blob URL also didn't work.\r\n\t\t\t\t*/\r\n\t\t\t\tthrow new Error(\"data URL formatted sound is not supported.\");\r\n\t\t\t\t/*\r\n\t\t\t\tmanifest.type = createjs.Types.SOUND;\r\n\t\t\t\tmanifest.src = dataURLToBlobURL(manifest.src);\r\n\t\t\t\t*/\r\n\t\t\t} else if (manifest.src.indexOf('blob:') === 0) {\r\n\r\n\t\t\t} else if (manifest.src.indexOf('file:') === 0) {\r\n\t\t\t\t\r\n\t\t\t} else {\r\n\t\t\t\tmanifest.src = PIXI.utils.url.resolve(target.basepath, manifest.src);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (crossOrigin) {\r\n\t\t\tfor (let i = 0; i < manifests.length; i++) {\r\n\t\t\t\tmanifests[i].crossOrigin = true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst loadPromise = new Promise((resolve, reject) => {\r\n\t\t\tif (manifests.length === 0) {\r\n\t\t\t\tresolve({});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst loader = new createjs.LoadQueue(false);\r\n\t\t\t\r\n\t\t\tif (target.options?.useSound) {\r\n\t\t\t\tloader.installPlugin(createjs.Sound);\r\n\t\t\t}\r\n\r\n\t\t\tconst errors: any[] = [];\r\n\t\t\t\r\n\t\t\tloader.addEventListener('fileload', (evt: any) => {\r\n\t\t\t\thandleFileLoad(evt, comp);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tloader.addEventListener('complete', (evt: any) => {\r\n\t\t\t\tif (errors.length) {\r\n\t\t\t\t\treject(errors);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tresolve(evt);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tloader.addEventListener('error', (evt: any) => {\r\n\t\t\t\terrors.push(evt.data);\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tloader.loadManifest(manifests || []);\r\n\t\t})\r\n\t\t.then((evt: any) => {\r\n\t\t\tconst ss = comp.getSpriteSheet();\r\n\t\t\tconst queue = evt.target;\r\n\t\t\tconst ssMetadata = lib.ssMetadata;\r\n\t\t\t\r\n\t\t\tfor (let i = 0; i < ssMetadata.length; i++) {\r\n\t\t\t\tss[ssMetadata[i].name] = new createjs.SpriteSheet({\r\n\t\t\t\t\timages: [\r\n\t\t\t\t\t\tqueue.getResult(ssMetadata[i].name)\r\n\t\t\t\t\t],\r\n\t\t\t\t\tframes: ssMetadata[i].frames\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn lib;\r\n\t\t});\r\n\r\n\t\tpromises.push(\r\n\t\t\tloadPromise\r\n\t\t\t.then((lib: IAnimateLibrary) => {\r\n\t\t\t\tfor (let i  in lib) {\r\n\t\t\t\t\tif (lib[i].prototype instanceof PA.CreatejsMovieClip) {\r\n\t\t\t\t\t\tlib[i].prototype._framerateBase = lib.properties.fps;\r\n\t\t\t\t\t\tlib[i].prototype._listenFrameEventsBase = target.options?.listenFrameEvents;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn lib;\r\n\t\t\t})\r\n\t\t);\r\n\t}\r\n\t\r\n\treturn Promise.all(promises)\r\n\t\t.then((resolvers: IAnimateLibrary[]) => {\r\n\t\t\tif (resolvers.length === 1) {\r\n\t\t\t\treturn resolvers[0];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn resolvers;\r\n\t\t});\r\n}\r\n\r\n/**\r\n * @ignore\r\n */\r\nfunction handleFileLoad(evt: any, comp: any) {\r\n\tconst images = comp.getImages();\r\n\tif (evt && (evt.item.type == 'image')) {\r\n\t\timages[evt.item.id] = evt.result;\r\n\t}\r\n}","import { Container as PixiContainer } from 'pixi.js';\r\nimport { CreatejsBitmap, CreatejsMovieClip, TCreatejsObject } from './createjs';\r\n\r\nexport interface ICreatejsMovieClipDictionary {\r\n\t[id: number]: CreatejsMovieClip;\r\n}\r\n\r\nexport interface IAnimateContainer extends PixiContainer {\r\n\thandleTick(delta: number): void;\r\n    /**\r\n     * Add a createjs instance as a child.\r\n     */\r\n\taddCreatejs(cjs: TCreatejsObject): TCreatejsObject;\r\n    /**\r\n     * Add a createjs instance as a child to the specified hierarchy.\r\n     */\r\n\taddCreatejsAt(cjs: TCreatejsObject, index: number): TCreatejsObject;\r\n\t/**\r\n     * Remove the createjs instance from the child.\r\n     */\r\n    removeCreatejs(cjs: TCreatejsObject): TCreatejsObject;\r\n\r\n    /**\r\n     * The playback speed multiplier for the createjs instance managed by this container. <br />\r\n     * This value multiplied by `delta time` determines the playback speed.\r\n     */\r\n    createjsSpeed: number;\r\n\r\n    /**\r\n     * Whether the playback speed of the createjs instance managed by this container can exceed `1`. <br />\r\n     * If the playback speed exceeds `1`, more than `2` frames may progress in one process, but this may result in unexpected behavior depending on the frame script.\r\n     */\r\n    createjsOverSpeed: boolean;\r\n}\r\n\r\nexport class CreatejsController {\r\n\tprivate _createjsData: {\r\n\t\tid: number;\r\n\t\ttargets: ICreatejsMovieClipDictionary;\r\n\t\tcontainer: IAnimateContainer;\r\n\t};\r\n\r\n    private _speed = 1;\r\n    get speed() {\r\n        return this._speed;\r\n    }\r\n    set speed(value: number) {\r\n        this._speed = value;\r\n    }\r\n\r\n    private _overSpeed = false;\r\n    get overSpeed() {\r\n        return this._overSpeed;\r\n    }\r\n    set overSpeed(value: boolean) {\r\n        this._overSpeed = value;\r\n    }\r\n\t\r\n\tconstructor(container: IAnimateContainer) {\r\n\t\tthis._createjsData = {\r\n\t\t\tid: 0,\r\n\t\t\ttargets: {},\r\n\t\t\tcontainer\r\n\t\t};\r\n\t}\r\n\t\r\n\thandleTick(delta: number) {\r\n        const d = delta * this._speed;\r\n\t\tconst e = { delta: this._overSpeed ? d : Math.min(d, 1)};\r\n\r\n\t\tconst targets = this._createjsData.targets;\r\n\t\tfor (let i in targets) {\r\n\t\t\ttargets[i].updateForPixi(e);\r\n\t\t}\r\n\t}\r\n\t\r\n\tprivate _addCreatejs(cjs: TCreatejsObject) {\r\n\t\tif (cjs instanceof CreatejsMovieClip) {\r\n\t\t\tconst p = cjs.pixi.parent;\r\n\t\t\t\r\n\t\t\tcjs.pixi.once('added', () => {\r\n\t\t\t\tif (cjs.pixi.parent !== p) {\r\n\t\t\t\t\tcjs.gotoAndPlay(0);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tconst id = this._createjsData.id++;\r\n\t\t\t\tthis._createjsData.targets[id] = cjs;\r\n\t\t\t\t\r\n\t\t\t\tcjs.pixi.once('removed', () => {\r\n\t\t\t\t\tdelete(this._createjsData.targets[id]);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t\r\n\taddCreatejs<T extends TCreatejsObject>(cjs: TCreatejsObject) {\r\n\t\tthis._addCreatejs(cjs);\r\n\t\tthis._createjsData.container.addChild(cjs.pixi);\r\n\t\t\r\n\t\treturn cjs as T;\r\n\t}\r\n\t\r\n\taddCreatejsAt<T extends TCreatejsObject>(cjs: TCreatejsObject, index: number) {\r\n\t\tthis._addCreatejs(cjs);\r\n\t\tthis._createjsData.container.addChildAt(cjs.pixi, index);\r\n\t\t\r\n\t\treturn cjs as T;\r\n\t}\r\n\t\r\n\tremoveCreatejs(cjs: TCreatejsObject) {\r\n\t\tthis._createjsData.container.removeChild(cjs.pixi);\r\n\t\t\r\n\t\treturn cjs;\r\n\t}\r\n}\r\n\r\n/**\r\n * inherited {@link https://tawaship.github.io/Pixim.js/classes/container.html | Pixim.Container}\r\n */\r\nexport class Container extends PixiContainer implements IAnimateContainer {\r\n\tprivate _createjsData: {\r\n\t\tcontroller: CreatejsController;\r\n\t};\r\n\t\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._createjsData = {\r\n\t\t\tcontroller: new CreatejsController(this)\r\n\t\t};\r\n\t}\r\n\r\n    get createjsSpeed() {\r\n        return this._createjsData.controller.speed;\r\n    }\r\n    set createjsSpeed(value: number) {\r\n        this._createjsData.controller.speed = value;\r\n    }\r\n\r\n    get createjsOverSpeed() {\r\n        return this._createjsData.controller.overSpeed;\r\n    }\r\n    set createjsOverSpeed(value: boolean) {\r\n        this._createjsData.controller.overSpeed = value;\r\n    }\r\n\t\r\n\thandleTick(delta: number) {\r\n\t\treturn this._createjsData.controller.handleTick(delta);\r\n\t}\r\n\t\r\n\taddCreatejs<T extends TCreatejsObject = TCreatejsObject>(cjs: TCreatejsObject) {\r\n\t\treturn this._createjsData.controller.addCreatejs<T>(cjs);\r\n\t}\r\n\t\r\n\taddCreatejsAt<T extends TCreatejsObject = TCreatejsObject>(cjs: TCreatejsObject, index: number) {\r\n\t\treturn this._createjsData.controller.addCreatejsAt<T>(cjs, index);\r\n\t}\r\n\t\r\n\tremoveCreatejs(cjs: TCreatejsObject) {\r\n\t\treturn this._createjsData.controller.removeCreatejs(cjs);\r\n\t}\r\n}","import * as PA from './createjs/modules';\r\nimport createjs from '@tawaship/createjs-module';\r\n\r\n// overrides\r\ncreatejs.Stage = PA.CreatejsStage;\r\ncreatejs.StageGL = PA.CreatejsStageGL;\r\ncreatejs.MovieClip = PA.CreatejsMovieClip;\r\ncreatejs.Sprite = PA.CreatejsSprite;\r\ncreatejs.Shape = PA.CreatejsShape;\r\ncreatejs.Bitmap = PA.CreatejsBitmap;\r\ncreatejs.Graphics = PA.CreatejsGraphics;\r\ncreatejs.Text = PA.CreatejsText;\r\ncreatejs.ButtonHelper = PA.CreatejsButtonHelper;\r\ncreatejs.ColorFilter = PA.CreatejsColorFilter;\r\n\r\n// install plugins\r\ncreatejs.MotionGuidePlugin.install();\r\n\r\nexport * from './createjs';\r\nexport * from './Container';"],"names":["CreatejsButtonHelper","superclass","super","apply","this","args","const","createjs","pixi","baseFrame","overFrame","downFrame","hit","arguments","hitFrame","gotoAndStop","hitPixi","addChild","alpha","let","isOver","isDown","on","interactive","cursor","ButtonHelper","createObject","proto","Object","create","DEG_TO_RAD","Math","PI","createPixiData","regObj","instance","reservedBlendMode","PIXI","BLEND_MODES","NORMAL","createCreatejsParams","x","y","scaleX","scaleY","regX","regY","skewX","skewY","rotation","visible","_off","mask","updateDisplayObjectChildren","cjs","e","list","children","slice","i","l","length","updateForPixi","mixinCreatejsDisplayObject","superClass","C","prototypeAccessors","_pixiData","_createjsParams","set","value","scale","skew","renderable","prototype","addEventListener","type","cb","p","concat","_createjsEventManager","add","removeEventListener","remove","removeAllEventListeners","removeAll","masked","push","once","parent","createjsInteractionEvents","CreatejsStage","props","tickOnUpdate","tick","dispatchEvent","updateBlendModeForPixi","mode","Stage","CreatejsStageGL","StageGL","exports","CreatejsEventManager","_downTarget","_cjs","_emitter","utils","EventEmitter","_onPointerDown","_onPointerMove","_onPointerUp","_onPointerUpOutside","_onPointerTap","_onPointerOver","_onPointerOut","ev","mousedown","currentTarget","target","rawX","data","global","rawY","emit","pressmove","pressup","click","rollover","rollout","eventNames","off","removeAllListeners","PixiMovieClip","Container","_filterContainer","_createjs","filterContainer","configurable","createCreatejsMovieClipParams","assign","filters","compositeOperation","createPixiMovieClipData","pivot","subInstance","CompositeOpeations","AnimateEvent","call","Event","AnimateReachLabelEvent","label","P","MovieClip","blendModes","Lighter","ADD","Multiply","MULTIPLY","Screen","SCREEN","T","CreatejsMovieClip","framerate","_framerateBase","_listenFrameEvents","_listenFrameEventsBase","prototypeAccessors$1","endAnimation","reachLabel","initialize","listenCustomFrameEvent","currentFrame","paused","advance","delta","totalFrames","labels","position","_updateState","blendMode","f","ColorFilter","_updateChildrenBlendModeForPixi","child","addChildAt","index","removeChild","removeChildAt","removeAllChldren","removeChildren","defineProperties","writable","PixiSprite","Sprite","createPixiSpriteData","anchor","CreatejsSprite","constructor","frame","spriteSheet","getFrame","baseTexture","BaseTexture","from","image","texture","Texture","rect","PixiShape","createCreatejsShapeParams","graphics","createPixiShapeData","Shape","CreatejsShape","_a","defaultPixiData","defaultCreatejsParams","PixiBitmap","createPixiBitmapData","Bitmap","CreatejsBitmap","res","PixiGraphics","Graphics","createPixiGraphicsData","strokeFill","strokeAlpha","LineCap","LINE_CAP","BUTT","ROUND","SQUARE","LineJoin","LINE_JOIN","MITER","BEVEL","CreatejsGraphics","beginFill","moveTo","clone","endFill","containsPoint","beginHole","endHole","mt","lineTo","lt","arcTo","x1","y1","x2","y2","radius","at","arc","startAngle","endAngle","anticlockwise","a","quadraticCurveTo","cpx","cpy","qt","curveTo","bezierCurveTo","cp1x","cp1y","cp2x","cp2y","bt","w","h","drawRect","r","dr","closePath","cp","clear","c","_parseColor","color","charAt","parseInt","colors","replace","split","Number","ef","setStrokeStyle","thickness","caps","joints","miterLimit","ignoreScale","lineTextureStyle","width","cap","join","ss","beginStroke","s","drawRoundRect","drawRoundedRect","rr","drawCircle","dc","drawEllipse","de","drawPolyStar","sides","pointSize","angle","drawRegularPolygon","dp","PixiText","Text","PixiTextContainer","text","_text","createCreatejsTextParams","font","textAlign","lineHeight","lineWidth","createPixiTextData","CreatejsText","_font","_parseFont","t","fontWeight","fontSize","fontFamily","fill","wordWrap","_align","shift","indexOf","style","align","height","wordWrapWidth","PixiColorMatrixFilter","ColorMatrixFilter","createPixiColorMatrixFilterData","createCreatejsColorFilterParams","redMultiplier","greenMultiplier","blueMultiplier","alphaMultiplier","redOffset","greenOffset","blueOffset","alphaOffset","CreatejsColorFilter","pixiData","createjsParams","enumerable","get","matrix","playSound","id","loop","offset","Sound","play","interrupt","INTERRUPT_EARLY","CreatejsController","container","_speed","_overSpeed","_createjsData","targets","speed","overSpeed","handleTick","d","min","_addCreatejs","gotoAndPlay","addCreatejs","addCreatejsAt","removeCreatejs","PixiContainer","controller","createjsSpeed","createjsOverSpeed","PA.CreatejsStage","PA.CreatejsStageGL","PA.CreatejsMovieClip","PA.CreatejsSprite","PA.CreatejsShape","PA.CreatejsBitmap","PA.CreatejsGraphics","PA.CreatejsText","PA.CreatejsButtonHelper","PA.CreatejsColorFilter","MotionGuidePlugin","install","Array","isArray","promises","options","useSound","window","comp","AdobeAn","getComposition","Error","lib","getLibrary","manifests","properties","manifest","map","v","JSON","parse","stringify","crossOrigin","_b","src","Types","IMAGE","url","resolve","basepath","loadPromise","Promise","reject","loader","LoadQueue","installPlugin","errors","evt","images","getImages","item","result","handleFileLoad","loadManifest","then","getSpriteSheet","queue","ssMetadata","name","SpriteSheet","getResult","frames","fps","listenFrameEvents","all","resolvers"],"mappings":"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"}